UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={};UE.plugins={};UE.commands={};UE.version="1.2.0.0";var dom=UE.dom={};var browser=UE.browser=function(){var b=navigator.userAgent.toLowerCase(),c=window.opera,d={ie:!!window.ActiveXObject,opera:!!c&&c.version,webkit:-1<b.indexOf(" applewebkit/"),mac:-1<b.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode};d.gecko="Gecko"==navigator.product&&!d.webkit&&!d.opera;var g=0;d.ie&&(g=parseFloat(b.match(/msie (\d+)/)[1]),d.ie8=!!document.documentMode,d.ie8Compat=8==document.documentMode,d.ie7Compat=7==g&&!document.documentMode||7==document.documentMode,d.ie6Compat=
7>g||d.quirks);if(d.gecko){var a=b.match(/rv:([\d\.]+)/);a&&(a=a[1].split("."),g=1E4*a[0]+100*(a[1]||0)+1*(a[2]||0))}/chrome\/(\d+\.\d)/i.test(b)&&(d.chrome=+RegExp.$1);/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(b)&&!/chrome/i.test(b)&&(d.safari=+(RegExp.$1||RegExp.$2));d.opera&&(g=parseFloat(c.version()));d.webkit&&(g=parseFloat(b.match(/ applewebkit\/(\d+)/)[1]));d.version=g;d.isCompatible=!d.mobile&&(d.ie&&6<=g||d.gecko&&10801<=g||d.opera&&9.5<=g||d.air&&1<=g||d.webkit&&522<=g||!1);return d}(),
ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko;var utils=UE.utils={makeInstance:function(b){var c=new Function;c.prototype=b;b=new c;c.prototype=null;return b},extend:function(b,c,d){if(c)for(var g in c)if(!d||!b.hasOwnProperty(g))b[g]=c[g];return b},isArray:function(b){return"[object Array]"===Object.prototype.toString.apply(b)},isString:function(b){return"string"==typeof b||b.constructor==String},inherits:function(b,c){var d=b.prototype,g=utils.makeInstance(c.prototype);utils.extend(g,d,!0);b.prototype=g;return g.constructor=b},bind:function(b,
c){return function(){return b.apply(c,arguments)}},defer:function(b,c,d){var g;return function(){d&&clearTimeout(g);g=setTimeout(b,c)}},indexOf:function(b,c,d){for(var d=d||0,g=b.length;d<g;d++)if(b[d]===c)return d;return-1},findNode:function(b,c,d){for(var g=0,a;a=b[g++];)if(d?d(a):-1!=this.indexOf(c,a.tagName.toLowerCase()))return a},removeItem:function(b,c){for(var d=0,g=b.length;d<g;d++)b[d]===c&&(b.splice(d,1),d--)},trim:function(b){return b.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(b){if(!b)return{};
for(var b=utils.isArray(b)?b:b.split(","),c=0,d,g={};d=b[c++];)g[d.toUpperCase()]=g[d]=1;return g},unhtml:function(b){return b?b.replace(/[&<">]/g,function(b){return{"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"}[b]}):""},cssStyleToDomStyle:function(){var b=document.createElement("div").style,c={"float":void 0!=b.cssFloat?"cssFloat":void 0!=b.styleFloat?"styleFloat":"float"};return function(b){return c[b]||(c[b]=b.toLowerCase().replace(/-./g,function(b){return b.charAt(1).toUpperCase()}))}}(),loadFile:function(b,
c,d){if(!c.id||!b.getElementById(c.id)){var g=b.createElement(c.tag);delete c.tag;for(var a in c)g.setAttribute(a,c[a]);g.onload=g.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState))d&&d(),g.onload=g.onreadystatechange=null};b.getElementsByTagName("head")[0].appendChild(g)}},isEmptyObject:function(b){for(var c in b)return!1;return!0},fixColor:function(b,c){if(/color/i.test(b)&&/rgba?/.test(c)){var d=c.split(",");if(3<d.length)return"";for(var c="#",g=0,a;a=
d[g++];)a=parseInt(a.replace(/[^\d]/gi,""),10).toString(16),c+=1==a.length?"0"+a:a;c=c.toUpperCase()}return c},optCss:function(b){function c(a,b){if(!a)return"";var e=a.top,f=a.bottom,j=a.left,i=a.right,d="";if(!e||!j||!f||!i)for(var g in a)d+=";"+b+"-"+g+":"+a[g]+";";else d+=";"+b+":"+(e==f&&f==j&&j==i?e:e==f&&j==i?e+" "+j:j==i?e+" "+j+" "+f:e+" "+i+" "+f+" "+j)+";";return d}var d,g,b=b.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(a,b,e,f){if(1==f.split(" ").length)switch(b){case "padding":return!d&&
(d={}),d[e]=f,"";case "margin":return!g&&(g={}),g[e]=f,"";case "border":return"initial"==f?"":a}return a}),b=b+(c(d,"padding")+c(g,"margin"));return b.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(a,b){return b?b+";;":";"})}};var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(b,c){getListener(this,b,!0).push(c)},removeListener:function(b,c){var d=getListener(this,b);d&&utils.removeItem(d,c)},fireEvent:function(b){var c=getListener(this,b),d,g,a;if(c)for(a=c.length;a--;)g=c[a].apply(this,arguments),void 0!==g&&(d=g);if(g=this["on"+b.toLowerCase()])d=g.apply(this,arguments);return d}};
function getListener(b,c,d){var g,c=c.toLowerCase();return(g=b.__allListeners||d&&(b.__allListeners={}))&&(g[c]||d&&(g[c]=[]))};var dtd=dom.dtd=function(){function b(a){for(var i in a)a[i.toUpperCase()]=a[i];return a}function c(a){for(var i=arguments,j=1;j<i.length;j++){var f=i[j],b;for(b in f)a.hasOwnProperty(b)||(a[b]=f[b])}return a}var d=b({isindex:1,fieldset:1}),g=b({input:1,button:1,select:1,textarea:1,label:1}),a=c(b({a:1}),g),h=c({iframe:1},a),e=b({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),f=b({ins:1,del:1,script:1,style:1}),
j=c(b({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),f),i=c(b({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),j),m=c(b({p:1}),i),g=c(b({iframe:1}),i,g),i=b({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,
textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),l=c(b({a:0}),g),k=b({tr:1}),n=b({"#":1}),t=c(b({param:1}),i),q=c(b({form:1}),d,h,e,m),o=b({li:1}),s=b({style:1,script:1}),r=b({base:1,link:1,meta:1,title:1}),s=c(r,s),u=b({head:1,body:1}),v=b({html:1}),x=b({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,
form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),y=b({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return b({$nonBodyContent:c(v,u,r),$block:x,$inline:l,$body:c(b({script:1,style:1}),x),$cdata:b({script:1,style:1}),$empty:y,$nonChild:b({iframe:1}),$listItem:b({dd:1,dt:1,li:1}),$list:b({ul:1,ol:1,dl:1}),$isNotEmpty:b({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),
$removeEmpty:b({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:b({p:1,div:1}),$tableContent:b({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:b({pre:1,script:1,style:1,textarea:1}),html:u,head:s,style:n,script:n,body:q,base:{},link:{},meta:{},title:n,col:{},tr:b({td:1,th:1}),img:{},embed:{},colgroup:b({thead:1,
col:1,tbody:1,tr:1,tfoot:1}),noscript:q,td:q,br:{},th:q,center:q,kbd:l,button:c(m,e),basefont:{},h5:l,h4:l,samp:l,h6:l,ol:o,h1:l,h3:l,option:n,h2:l,form:c(d,h,e,m),select:b({optgroup:1,option:1}),font:l,ins:l,menu:o,abbr:l,label:l,table:b({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:l,tfoot:k,cite:l,li:q,input:{},iframe:q,strong:l,textarea:n,noframes:q,big:l,small:l,span:b({"#":1,br:1}),hr:l,dt:l,sub:l,optgroup:b({option:1}),param:{},bdo:l,"var":l,div:q,object:t,sup:l,dd:q,strike:l,
area:{},dir:o,map:c(b({area:1,form:1,p:1}),d,f,e),applet:t,dl:b({dt:1,dd:1}),del:l,isindex:{},fieldset:c(b({legend:1}),i),thead:k,ul:o,acronym:l,b:l,a:c(b({a:1}),g),blockquote:c(b({td:1,tr:1,tbody:1,li:1}),q),caption:l,i:l,u:l,tbody:k,s:l,address:c(h,m),tt:l,legend:l,q:l,pre:c(j,a),p:c(b({a:1}),l),em:l,dfn:l})}();function getDomNode(b,c,d,g,a,h){var g=g&&b[c],e;for(!g&&(g=b[d]);!g&&(e=(e||b).parentNode);){if("BODY"==e.tagName||h&&!h(e))return null;g=e[d]}return g&&a&&!a(g)?getDomNode(g,c,d,!1,a):g}
var attrFix=ie&&9>browser.version?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap("-webkit-box -moz-box block list-item table table-row-group table-header-group table-footer-group table-row table-column-group table-column table-cell table-caption".split(" ")),
domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&"6"==browser.version?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(b,c){if(b===c)return 0;var d,g=[b],a=[c];for(d=b;d=d.parentNode;){if(d===c)return 10;g.push(d)}for(d=c;d=d.parentNode;){if(d===b)return 20;
a.push(d)}g.reverse();a.reverse();if(g[0]!==a[0])return 1;for(d=-1;d++,g[d]===a[d];);b=g[d];for(c=a[d];b=b.nextSibling;)if(b===c)return 4;return 2},getNodeIndex:function(b){for(var c=b.parentNode.firstChild,d=0;b!==c;)d++,c=c.nextSibling;return d},inDoc:function(b,c){for(;b=b.parentNode;)if(b===c)return!0;return!1},findParent:function(b,c,d){if(!domUtils.isBody(b))for(b=d?b:b.parentNode;b;){if(!c||c(b)||this.isBody(b))return c&&!c(b)&&this.isBody(b)?null:b;b=b.parentNode}return null},findParentByTagName:function(b,
c,d,g){if(b&&b.nodeType&&!this.isBody(b)&&(1==b.nodeType||b.nodeType)){c=utils.listToMap(utils.isArray(c)?c:[c]);for(b=3==b.nodeType||!d?b.parentNode:b;b&&(b.tagName&&9!=b.nodeType)&&(!g||!g(b));){if(c[b.tagName])return b;b=b.parentNode}}return null},findParents:function(b,c,d,g){for(c=c&&(d&&d(b)||!d)?[b]:[];b=domUtils.findParent(b,d);)c.push(b);return g?c:c.reverse()},insertAfter:function(b,c){return b.parentNode.insertBefore(c,b.nextSibling)},remove:function(b,c){var d=b.parentNode,g;if(d){if(c&&
b.hasChildNodes())for(;g=b.firstChild;)d.insertBefore(g,b);d.removeChild(b)}return b},getNextDomNode:function(b,c,d,g){return getDomNode(b,"firstChild","nextSibling",c,d,g)},isBookmarkNode:function(b){return 1==b.nodeType&&b.id&&/^_baidu_bookmark_/i.test(b.id)},getWindow:function(b){b=b.ownerDocument||b;return b.defaultView||b.parentWindow},getCommonAncestor:function(b,c){if(b===c)return b;for(var d=[b],g=[c],a=b,h=-1;a=a.parentNode;){if(a===c)return a;d.push(a)}for(a=c;a=a.parentNode;){if(a===b)return a;
g.push(a)}d.reverse();for(g.reverse();h++,d[h]===g[h];);return 0==h?null:d[h-1]},clearEmptySibling:function(b,c,d){function g(a,b){for(var e;a&&!domUtils.isBookmarkNode(a)&&(domUtils.isEmptyInlineElement(a)||domUtils.isWhitespace(a));)e=a[b],domUtils.remove(a),a=e}!c&&g(b.nextSibling,"nextSibling");!d&&g(b.previousSibling,"previousSibling")},split:function(b,c){var d=b.ownerDocument;if(browser.ie&&c==b.nodeValue.length){var g=d.createTextNode("");return domUtils.insertAfter(b,g)}g=b.splitText(c);
browser.ie8&&(d=d.createTextNode(""),domUtils.insertAfter(g,d),domUtils.remove(d));return g},isWhitespace:function(b){return!RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(b.nodeValue)},getXY:function(b){for(var c=0,d=0;b.offsetParent;)d+=b.offsetTop,c+=b.offsetLeft,b=b.offsetParent;return{x:c,y:d}},on:function(b,c,d){var g=c instanceof Array?c:[c],a=g.length;if(a)for(;a--;)if(c=g[a],b.addEventListener)b.addEventListener(c,d,!1);else{d._d||(d._d={});var h=c+d.toString();d._d[h]||(d._d[h]=function(a){return d.call(a.srcElement,
a||window.event)},b.attachEvent("on"+c,d._d[h]))}b=null},un:function(b,c,d){var g=c instanceof Array?c:[c],a=g.length;if(a)for(;a--;)if(c=g[a],b.removeEventListener)b.removeEventListener(c,d,!1);else{var h=c+d.toString();b.detachEvent("on"+c,d._d?d._d[h]:d);d._d&&d._d[h]&&delete d._d[h]}},isSameElement:function(b,c){if(b.tagName!=c.tagName)return 0;var d=b.attributes,g=c.attributes;if(!ie&&d.length!=g.length)return 0;for(var a,h,e=0,f=0,j=0;a=d[j++];){if("style"==a.nodeName)if(a.specified&&e++,domUtils.isSameStyle(b,
c))continue;else return 0;if(ie)if(a.specified)e++,h=g.getNamedItem(a.nodeName);else continue;else h=c.attributes[a.nodeName];if(!h.specified||a.nodeValue!=h.nodeValue)return 0}if(ie){for(j=0;h=g[j++];)h.specified&&f++;if(e!=f)return 0}return 1},isSameStyle:function(b,c){var d=b.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),g=c.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(!d||!g)return d==g?1:0;d=d.split(";");g=g.split(";");if(d.length!=g.length)return 0;for(var a=
0,h;h=d[a++];)if(-1==utils.indexOf(g,h))return 0;return 1},isBlockElm:function(b){return 1==b.nodeType&&(dtd.$block[b.tagName]||styleBlock[domUtils.getComputedStyle(b,"display")])&&!dtd.$nonChild[b.tagName]},isBody:function(b){return b&&1==b.nodeType&&"body"==b.tagName.toLowerCase()},breakParent:function(b,c){var d,g=b,a=b,h,e;do{g=g.parentNode;h?(d=g.cloneNode(!1),d.appendChild(h),h=d,d=g.cloneNode(!1),d.appendChild(e),e=d):(h=g.cloneNode(!1),e=h.cloneNode(!1));for(;d=a.previousSibling;)h.insertBefore(d,
h.firstChild);for(;d=a.nextSibling;)e.appendChild(d);a=g}while(c!==g);d=c.parentNode;d.insertBefore(h,c);d.insertBefore(e,c);d.insertBefore(b,e);domUtils.remove(c);return b},isEmptyInlineElement:function(b){if(1!=b.nodeType||!dtd.$removeEmpty[b.tagName])return 0;for(b=b.firstChild;b;){if(domUtils.isBookmarkNode(b)||1==b.nodeType&&!domUtils.isEmptyInlineElement(b)||3==b.nodeType&&!domUtils.isWhitespace(b))return 0;b=b.nextSibling}return 1},trimWhiteTextNode:function(b){function c(d){for(var g;(g=b[d])&&
3==g.nodeType&&domUtils.isWhitespace(g);)b.removeChild(g)}c("firstChild");c("lastChild")},mergChild:function(b,c,d){for(var g=domUtils.getElementsByTagName(b,b.tagName.toLowerCase()),a=0,h;h=g[a++];)if(h.parentNode&&!domUtils.isBookmarkNode(h))if("span"==h.tagName.toLowerCase()){if(b===h.parentNode&&(domUtils.trimWhiteTextNode(b),1==b.childNodes.length)){b.style.cssText=h.style.cssText+";"+b.style.cssText;domUtils.remove(h,!0);continue}h.style.cssText=b.style.cssText+";"+h.style.cssText;if(d){var e=
d.style;if(e)for(var e=e.split(";"),f=0,j;j=e[f++];)h.style[utils.cssStyleToDomStyle(j.split(":")[0])]=j.split(":")[1]}domUtils.isSameStyle(h,b)&&domUtils.remove(h,!0)}else domUtils.isSameElement(b,h)&&domUtils.remove(h,!0);if("span"==c){c=domUtils.getElementsByTagName(b,"a");for(a=0;d=c[a++];)d.style.cssText=";"+b.style.cssText,d.style.textDecoration="underline"}},getElementsByTagName:function(b,c){for(var d=b.getElementsByTagName(c),g=[],a=0,h;h=d[a++];)g.push(h);return g},mergToParent:function(b){for(var c=
b.parentNode;c&&dtd.$removeEmpty[c.tagName];){if(c.tagName==b.tagName||"A"==c.tagName){domUtils.trimWhiteTextNode(c);if("SPAN"==c.tagName&&!domUtils.isSameStyle(c,b)||"A"==c.tagName&&"SPAN"==b.tagName)if(1<c.childNodes.length||c!==b.parentNode){b.style.cssText=c.style.cssText+";"+b.style.cssText;c=c.parentNode;continue}else c.style.cssText+=";"+b.style.cssText,"A"==c.tagName&&(c.style.textDecoration="underline");if("A"!=c.tagName){c===b.parentNode&&domUtils.remove(b,!0);break}}c=c.parentNode}},mergSibling:function(b,
c,d){function g(a,b,e){var f;if((f=e[a])&&!domUtils.isBookmarkNode(f)&&1==f.nodeType&&domUtils.isSameElement(e,f)){for(;f.firstChild;)"firstChild"==b?e.insertBefore(f.lastChild,e.firstChild):e.appendChild(f.firstChild);domUtils.remove(f)}}!c&&g("previousSibling","firstChild",b);!d&&g("nextSibling","lastChild",b)},unselectable:gecko?function(b){b.style.MozUserSelect="none"}:webkit?function(b){b.style.KhtmlUserSelect="none"}:function(b){b.onselectstart=function(){return!1};b.onclick=b.onkeyup=b.onkeydown=
function(){return!1};b.unselectable="on";b.setAttribute("unselectable","on");for(var c=0,d;d=b.all[c++];)switch(d.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:d.unselectable="on",b.setAttribute("unselectable","on")}},removeAttributes:function(b,c){for(var d=0,g;g=c[d++];){g=attrFix[g]||g;switch(g){case "className":b[g]="";break;case "style":b.style.cssText="",!browser.ie&&b.removeAttributeNode(b.getAttributeNode("style"))}b.removeAttribute(g)}},setAttributes:function(b,
c){for(var d in c){var g=c[d];switch(d){case "class":b.className=g;break;case "style":b.style.cssText=b.style.cssText+";"+g;break;case "innerHTML":b[d]=g;break;case "value":b.value=g;break;default:b.setAttribute(attrFix[d]||d,g)}}return b},getComputedStyle:function(b,c){3==b.nodeType&&(b=b.parentNode);if(browser.ie&&9>browser.version&&"font-size"==c&&!b.style.fontSize&&!dtd.$empty[b.tagName]&&!dtd.$nonChild[b.tagName]){var d=b.ownerDocument.createElement("span");d.style.cssText="padding:0;border:0;font-family:simsun;";
d.innerHTML=".";b.appendChild(d);var g=d.offsetHeight;b.removeChild(d);return g+"px"}try{d=domUtils.getStyle(b,c)||(window.getComputedStyle?domUtils.getWindow(b).getComputedStyle(b,"").getPropertyValue(c):(b.currentStyle||b.style)[utils.cssStyleToDomStyle(c)])}catch(a){return null}d=utils.fixColor(c,d);"font-size"==c&&/pt$/.test(d)&&(d=Math.round(parseFloat(d)/0.75)+"px");return d},removeClasses:function(b,c){b.className=(" "+b.className+" ").replace(RegExp("(?:\\s+(?:"+c.join("|")+"))+\\s+","g"),
" ")},addClassName:function(b,c){this.hasClass(b,c)||(b.className=b.className+" "+c)},delClassName:function(b,c){this.hasClass(b,c)&&(b.className=b.className.replace(RegExp("(^"+c+"\\s+)|(\\s+"+c+"\\s+)|(\\s+"+c+"$)","g")," "))},removeStyle:function(b,c){b.style[utils.cssStyleToDomStyle(c)]="";b.style.cssText||domUtils.removeAttributes(b,["style"])},hasClass:function(b,c){return-1<(" "+b.className+" ").indexOf(" "+c+" ")},preventDefault:function(b){b.preventDefault?b.preventDefault():b.returnValue=
!1},getStyle:function(b,c){var d=b.style[utils.cssStyleToDomStyle(c)];return utils.fixColor(c,d)},setStyle:function(b,c,d){b.style[utils.cssStyleToDomStyle(c)]=d},setStyles:function(b,c){for(var d in c)c.hasOwnProperty(d)&&domUtils.setStyle(b,d,c[d])},removeDirtyAttr:function(b){for(var c=0,d,g=b.getElementsByTagName("*");d=g[c++];)d.removeAttribute("_moz_dirty");b.removeAttribute("_moz_dirty")},getChildCount:function(b,c){for(var d=0,g=b.firstChild,c=c||function(){return 1};g;)c(g)&&d++,g=g.nextSibling;
return d},isEmptyNode:function(b){return!b.firstChild||0==domUtils.getChildCount(b,function(b){return!domUtils.isBr(b)&&!domUtils.isBookmarkNode(b)&&!domUtils.isWhitespace(b)})},clearSelectedArr:function(b){for(var c;c=b.pop();)domUtils.removeAttributes(c,["class"])},scrollToView:function(b,c,d){var g=function(){var a=c.document,b="CSS1Compat"==a.compatMode;return{width:(b?a.documentElement.clientWidth:a.body.clientWidth)||0,height:(b?a.documentElement.clientHeight:a.body.clientHeight)||0}}().height,
d=-1*g+d+(b.offsetHeight||0),b=domUtils.getXY(b),d=d+b.y,b=function(a){if("pageXOffset"in a)return{x:a.pageXOffset||0,y:a.pageYOffset||0};a=a.document;return{x:a.documentElement.scrollLeft||a.body.scrollLeft||0,y:a.documentElement.scrollTop||a.body.scrollTop||0}}(c).y;if(d>b||d<b-g)c.scrollTo(0,d+(0>d?-20:20))},isBr:function(b){return 1==b.nodeType&&"BR"==b.tagName},isFillChar:function(b){return 3==b.nodeType&&!b.nodeValue.replace(RegExp(domUtils.fillChar),"").length},isStartInblock:function(b){for(var b=
b.cloneRange(),c=0,d=b.startContainer,g;d&&domUtils.isFillChar(d);)g=d,d=d.previousSibling;g&&(b.setStartBefore(g),d=b.startContainer);for(1==d.nodeType&&(domUtils.isEmptyNode(d)&&1==b.startOffset)&&b.setStart(d,0).collapse(!0);!b.startOffset;){d=b.startContainer;if(domUtils.isBlockElm(d)||domUtils.isBody(d)){c=1;break}g=b.startContainer.previousSibling;var a;if(g){for(;g&&domUtils.isFillChar(g);)a=g,g=g.previousSibling;a?b.setStartBefore(a):b.setStartBefore(b.startContainer)}else b.setStartBefore(b.startContainer)}return c&&
!domUtils.isBody(b.startContainer)?1:0},isEmptyBlock:function(b){if(0<b[browser.ie?"innerText":"textContent"].replace(RegExp("[ \t\r\n"+domUtils.fillChar+"]","g"),"").length)return 0;for(var c in dtd.$isNotEmpty)if(b.getElementsByTagName(c).length)return 0;return 1},setViewportOffset:function(b,c){var d=parseInt(b.style.left)|0,g=parseInt(b.style.top)|0,a=b.getBoundingClientRect(),h=c.left-a.left,a=c.top-a.top;h&&(b.style.left=d+h+"px");a&&(b.style.top=g+a+"px")},fillNode:function(b,c){var d=browser.ie?
b.createTextNode(domUtils.fillChar):b.createElement("br");c.innerHTML="";c.appendChild(d)},moveChild:function(b,c,d){for(;b.firstChild;)d&&c.firstChild?c.insertBefore(b.lastChild,c.firstChild):c.appendChild(b.firstChild)},hasNoAttributes:function(b){return browser.ie?/^<\w+\s*?>/.test(b.outerHTML):0==b.attributes.length}},fillCharReg=RegExp(domUtils.fillChar,"g");(function(){function b(a,i,f,b){if(1==i.nodeType&&(dtd.$empty[i.tagName]||dtd.$nonChild[i.tagName]))f=domUtils.getNodeIndex(i)+(a?0:1),i=i.parentNode;a?(b.startContainer=i,b.startOffset=f,b.endContainer||b.collapse(!0)):(b.endContainer=i,b.endOffset=f,b.startContainer||b.collapse(!1));b.collapsed=b.startContainer&&b.endContainer&&b.startContainer===b.endContainer&&b.startOffset==b.endOffset;return b}function c(a,i){var b=a.startContainer,f=a.endContainer,e=a.startOffset,h=a.endOffset,d=a.document,
g=d.createDocumentFragment(),c,s;1==b.nodeType&&(b=b.childNodes[e]||(c=b.appendChild(d.createTextNode(""))));1==f.nodeType&&(f=f.childNodes[h]||(s=f.appendChild(d.createTextNode(""))));if(b===f&&3==b.nodeType)return g.appendChild(d.createTextNode(b.substringData(e,h-e))),i&&(b.deleteData(e,h-e),a.collapse(!0)),g;for(var r,u,v=g,x=domUtils.findParents(b,!0),y=domUtils.findParents(f,!0),w=0;x[w]==y[w];w++);for(var z=w,A;A=x[z];z++){r=A.nextSibling;A==b?c||(3==a.startContainer.nodeType?(v.appendChild(d.createTextNode(b.nodeValue.slice(e))),
i&&b.deleteData(e,b.nodeValue.length-e)):v.appendChild(!i?b.cloneNode(!0):b)):(u=A.cloneNode(!1),v.appendChild(u));for(;r&&!(r===f||r===y[z]);)A=r.nextSibling,v.appendChild(!i?r.cloneNode(!0):r),r=A;v=u}v=g;x[w]||(v.appendChild(x[w-1].cloneNode(!1)),v=v.firstChild);for(z=w;e=y[z];z++){r=e.previousSibling;e==f?!s&&3==a.endContainer.nodeType&&(v.appendChild(d.createTextNode(f.substringData(0,h))),i&&f.deleteData(0,h)):(u=e.cloneNode(!1),v.appendChild(u));if(z!=w||!x[w])for(;r&&r!==b;)e=r.previousSibling,
v.insertBefore(!i?r.cloneNode(!0):r,v.firstChild),r=e;v=u}i&&a.setStartBefore(!y[w]?y[w-1]:!x[w]?x[w-1]:y[w]).collapse(!0);c&&domUtils.remove(c);s&&domUtils.remove(s);return g}function d(a,i){try{if(e&&domUtils.inDoc(e,a))if(e.nodeValue.replace(fillCharReg,"").length)e.nodeValue=e.nodeValue.replace(fillCharReg,"");else{var b=e.parentNode;for(domUtils.remove(e);b&&domUtils.isEmptyInlineElement(b)&&!b.contains(i);)e=b.parentNode,domUtils.remove(b),b=e}}catch(f){}}function g(a,i){for(var b,a=a[i];a&&
domUtils.isFillChar(a);)b=a[i],domUtils.remove(a),a=b}var a=0,h=domUtils.fillChar,e,f=dom.Range=function(a){this.startContainer=this.startOffset=this.endContainer=this.endOffset=null;this.document=a;this.collapsed=!0};f.prototype={cloneContents:function(){return this.collapsed?null:c(this,0)},deleteContents:function(){this.collapsed||c(this,1);if(browser.webkit){var a=this.startContainer;3==a.nodeType&&!a.nodeValue.length&&(this.setStartBefore(a).collapse(!0),domUtils.remove(a))}return this},extractContents:function(){return this.collapsed?
null:c(this,2)},setStart:function(a,i){return b(!0,a,i,this)},setEnd:function(a,i){return b(!1,a,i,this)},setStartAfter:function(a){return this.setStart(a.parentNode,domUtils.getNodeIndex(a)+1)},setStartBefore:function(a){return this.setStart(a.parentNode,domUtils.getNodeIndex(a))},setEndAfter:function(a){return this.setEnd(a.parentNode,domUtils.getNodeIndex(a)+1)},setEndBefore:function(a){return this.setEnd(a.parentNode,domUtils.getNodeIndex(a))},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},
selectNodeContents:function(a){return this.setStart(a,0).setEnd(a,3==a.nodeType?a.nodeValue.length:a.childNodes.length)},cloneRange:function(){return(new f(this.document)).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)},collapse:function(a){a?(this.endContainer=this.startContainer,this.endOffset=this.startOffset):(this.startContainer=this.endContainer,this.startOffset=this.endOffset);this.collapsed=!0;return this},shrinkBoundary:function(a){for(var i,b=this.collapsed;1==
this.startContainer.nodeType&&(i=this.startContainer.childNodes[this.startOffset])&&1==i.nodeType&&!domUtils.isBookmarkNode(i)&&!dtd.$empty[i.tagName]&&!dtd.$nonChild[i.tagName];)this.setStart(i,0);if(b)return this.collapse(!0);if(!a)for(;1==this.endContainer.nodeType&&0<this.endOffset&&(i=this.endContainer.childNodes[this.endOffset-1])&&1==i.nodeType&&!domUtils.isBookmarkNode(i)&&!dtd.$empty[i.tagName]&&!dtd.$nonChild[i.tagName];)this.setEnd(i,i.childNodes.length);return this},getCommonAncestor:function(a,
i){var b=this.startContainer,f=this.endContainer;return b===f?a&&1==b.nodeType&&this.startOffset==this.endOffset-1?b.childNodes[this.startOffset]:i&&3==b.nodeType?b.parentNode:b:domUtils.getCommonAncestor(b,f)},trimBoundary:function(a){this.txtToElmBoundary();var i=this.startContainer,b=this.startOffset,f=this.collapsed,e=this.endContainer;if(3==i.nodeType){if(0==b)this.setStartBefore(i);else if(b>=i.nodeValue.length)this.setStartAfter(i);else{var h=domUtils.split(i,b);i===e?this.setEnd(h,this.endOffset-
b):i.parentNode===e&&(this.endOffset+=1);this.setStartBefore(h)}if(f)return this.collapse(!0)}a||(b=this.endOffset,e=this.endContainer,3==e.nodeType&&(0==b?this.setEndBefore(e):(b>=e.nodeValue.length||domUtils.split(e,b),this.setEndAfter(e))));return this},txtToElmBoundary:function(){function a(i,b){var f=i[b+"Container"],e=i[b+"Offset"];if(3==f.nodeType)if(e){if(e>=f.nodeValue.length)i["set"+b.replace(/(\w)/,function(a){return a.toUpperCase()})+"After"](f)}else i["set"+b.replace(/(\w)/,function(a){return a.toUpperCase()})+
"Before"](f)}this.collapsed||(a(this,"start"),a(this,"end"));return this},insertNode:function(a){var i=a,b=1;11==a.nodeType&&(i=a.firstChild,b=a.childNodes.length);this.trimBoundary(!0);var f=this.startContainer,e=f.childNodes[this.startOffset];e?f.insertBefore(a,e):f.appendChild(a);i.parentNode===this.endContainer&&(this.endOffset+=b);return this.setStartBefore(i)},setCursor:function(a,i){return this.collapse(a?!1:!0).select(i)},createBookmark:function(b,i){var f,e=this.document.createElement("span");
e.style.cssText="display:none;line-height:0px;";e.appendChild(this.document.createTextNode("\ufeff"));e.id="_baidu_bookmark_start_"+(i?"":a++);this.collapsed||(f=e.cloneNode(!0),f.id="_baidu_bookmark_end_"+(i?"":a++));this.insertNode(e);f&&(this.collapse(!1).insertNode(f),this.setEndBefore(f));this.setStartAfter(e);return{start:b?e.id:e,end:f?b?f.id:f:null,id:b}},moveToBookmark:function(a){var i=a.id?this.document.getElementById(a.start):a.start,a=a.end&&a.id?this.document.getElementById(a.end):a.end;
this.setStartBefore(i);domUtils.remove(i);a?(this.setEndBefore(a),domUtils.remove(a)):this.collapse(!0);return this},enlarge:function(a,i){var b=domUtils.isBody,f,e,h=this.document.createTextNode("");if(a){e=this.startContainer;1==e.nodeType?e.childNodes[this.startOffset]?f=e=e.childNodes[this.startOffset]:(e.appendChild(h),f=e=h):f=e;for(;;){if(domUtils.isBlockElm(e)){for(e=f;(f=e.previousSibling)&&!domUtils.isBlockElm(f);)e=f;this.setStartBefore(e);break}f=e;e=e.parentNode}e=this.endContainer;1==
e.nodeType?((f=e.childNodes[this.endOffset])?e.insertBefore(h,f):e.appendChild(h),f=e=h):f=e;for(;;){if(domUtils.isBlockElm(e)){for(e=f;(f=e.nextSibling)&&!domUtils.isBlockElm(f);)e=f;this.setEndAfter(e);break}f=e;e=e.parentNode}h.parentNode===this.endContainer&&this.endOffset--;domUtils.remove(h)}if(!this.collapsed){for(;0==this.startOffset&&(!i||!i(this.startContainer))&&!b(this.startContainer);)this.setStartBefore(this.startContainer);for(;this.endOffset==(1==this.endContainer.nodeType?this.endContainer.childNodes.length:
this.endContainer.nodeValue.length)&&(!i||!i(this.endContainer))&&!b(this.endContainer);)this.setEndAfter(this.endContainer)}return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(a,
i,b){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(a){return a.nodeType==1&&domUtils.isBlockElm(a)}).adjustmentBoundary();for(var f=this.createBookmark(),e=f.end,h=function(a){return 1==a.nodeType?"br"!=a.tagName.toLowerCase():!domUtils.isWhitespace(a)},d=domUtils.getNextDomNode(f.start,!1,h),g,c,s=this.cloneRange();d&&domUtils.getPosition(d,e)&domUtils.POSITION_PRECEDING;)if(3==d.nodeType||dtd[a][d.tagName]){s.setStartBefore(d);for(g=d;g&&(3==g.nodeType||dtd[a][g.tagName])&&
g!==e;)c=g,g=domUtils.getNextDomNode(g,1==g.nodeType,null,function(b){return dtd[a][b.tagName]});var d=s.setEndAfter(c).extractContents(),r;if(b&&0<b.length){var u;u=r=b[0].cloneNode(!1);for(var v=1,x;x=b[v++];)r.appendChild(x.cloneNode(!1)),r=r.firstChild}else r=s.document.createElement(a);i&&domUtils.setAttributes(r,i);r.appendChild(d);s.insertNode(b?u:r);var y;"span"==a&&i.style&&/text\-decoration/.test(i.style)&&(y=domUtils.findParentByTagName(r,"a",!0))?(domUtils.setAttributes(y,i),domUtils.remove(r,
!0),r=y):(domUtils.mergSibling(r),domUtils.clearEmptySibling(r));domUtils.mergChild(r,a,i);d=domUtils.getNextDomNode(r,!1,h);domUtils.mergToParent(r);if(g===e)break}else d=domUtils.getNextDomNode(d,!0,h);return this.moveToBookmark(f)},removeInlineStyle:function(a){if(this.collapsed)return this;a=utils.isArray(a)?a:[a];this.shrinkBoundary().adjustmentBoundary();for(var b=this.startContainer,f=this.endContainer;;){if(1==b.nodeType){if(-1<utils.indexOf(a,b.tagName.toLowerCase()))break;if("body"==b.tagName.toLowerCase()){b=
null;break}}b=b.parentNode}for(;;){if(1==f.nodeType){if(-1<utils.indexOf(a,f.tagName.toLowerCase()))break;if("body"==f.tagName.toLowerCase()){f=null;break}}f=f.parentNode}var e=this.createBookmark(),h,d;b&&(d=this.cloneRange().setEndBefore(e.start).setStartBefore(b),h=d.extractContents(),d.insertNode(h),domUtils.clearEmptySibling(b,!0),b.parentNode.insertBefore(e.start,b));f&&(d=this.cloneRange().setStartAfter(e.end).setEndAfter(f),h=d.extractContents(),d.insertNode(h),domUtils.clearEmptySibling(f,
!1,!0),f.parentNode.insertBefore(e.end,f.nextSibling));for(b=domUtils.getNextDomNode(e.start,!1,function(a){return a.nodeType==1});b&&b!==e.end;)f=domUtils.getNextDomNode(b,!0,function(a){return a.nodeType==1}),-1<utils.indexOf(a,b.tagName.toLowerCase())&&domUtils.remove(b,!0),b=f;return this.moveToBookmark(e)},getClosedNode:function(){var a;if(!this.collapsed){var b=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(1==b.startContainer.nodeType&&b.startContainer===b.endContainer&&1==b.endOffset-
b.startOffset&&(b=b.startContainer.childNodes[b.startOffset])&&1==b.nodeType&&(dtd.$empty[b.tagName]||dtd.$nonChild[b.tagName]))a=b}return a},select:browser.ie?function(a,b){var f;this.collapsed||this.shrinkBoundary();var c=this.getClosedNode();if(c&&!b){try{f=this.document.body.createControlRange(),f.addElement(c),f.select()}catch(k){}return this}var c=this.createBookmark(),n=c.start;f=this.document.body.createTextRange();f.moveToElementText(n);f.moveStart("character",1);if(this.collapsed){if(!a&&
3!=this.startContainer.nodeType){var t=this.document.createTextNode(h),q=this.document.createElement("span");q.appendChild(this.document.createTextNode(h));n.parentNode.insertBefore(q,n);n.parentNode.insertBefore(t,n);d(this.document,t);e=t;g(q,"previousSibling");g(n,"nextSibling");f.moveStart("character",-1);f.collapse(!0)}}else t=this.document.body.createTextRange(),n=c.end,t.moveToElementText(n),f.setEndPoint("EndToEnd",t);this.moveToBookmark(c);q&&domUtils.remove(q);f.select();return this}:function(a){var b=
domUtils.getWindow(this.document),f=b.getSelection();browser.gecko?this.document.body.focus():b.focus();f&&(f.removeAllRanges(),this.collapsed&&!a&&(a=this.document.createTextNode(h),this.insertNode(a),d(this.document,a),g(a,"previousSibling"),g(a,"nextSibling"),e=a,this.setStart(a,browser.webkit?1:0).collapse(!0)),a=this.document.createRange(),a.setStart(this.startContainer,this.startOffset),a.setEnd(this.endContainer,this.endOffset),f.addRange(a));return this},scrollToView:function(a,b){var a=a?
window:domUtils.getWindow(this.document),f=this.document.createElement("span");f.innerHTML="&nbsp;";this.cloneRange().insertNode(f);domUtils.scrollToView(f,a,b);domUtils.remove(f);return this}}})();(function(){function b(b,a){var h=domUtils.getNodeIndex,b=b.duplicate();b.collapse(a);var e=b.parentElement();if(!e.hasChildNodes())return{container:e,offset:0};for(var f=e.children,d,i=b.duplicate(),c=0,l=f.length-1,k=-1;c<=l;){k=Math.floor((c+l)/2);d=f[k];i.moveToElementText(d);var n=i.compareEndPoints("StartToStart",b);if(0<n)l=k-1;else if(0>n)c=k+1;else return{container:e,offset:h(d)}}if(-1==k){i.moveToElementText(e);i.setEndPoint("StartToStart",b);i=i.text.replace(/(\r\n|\r)/g,"\n").length;f=
e.childNodes;if(!i)return d=f[f.length-1],{container:d,offset:d.nodeValue.length};for(h=f.length;0<i;)i-=f[--h].nodeValue.length;return{container:f[h],offset:-i}}i.collapse(0<n);i.setEndPoint(0<n?"StartToStart":"EndToStart",b);i=i.text.replace(/(\r\n|\r)/g,"\n").length;if(!i)return dtd.$empty[d.tagName]||dtd.$nonChild[d.tagName]?{container:e,offset:h(d)+(0<n?0:1)}:{container:d,offset:0<n?0:d.childNodes.length};for(;0<i;)try{f=d,d=d[0<n?"previousSibling":"nextSibling"],i-=d.nodeValue.length}catch(t){return{container:e,
offset:h(f)}}return{container:d,offset:0<n?-i:d.nodeValue.length+i}}function c(d,a){if(d.item)a.selectNode(d.item(0));else{var h=b(d,!0);a.setStart(h.container,h.offset);0!=d.compareEndPoints("StartToEnd",d)&&(h=b(d,!1),a.setEnd(h.container,h.offset))}return a}function d(b){var a;try{a=b.getNative().createRange()}catch(d){return null}var e=a.item?a.item(0):a.parentElement();return(e.ownerDocument||e)===b.document?a:null}(dom.Selection=function(b){var a=this;a.document=b;ie&&(b=domUtils.getWindow(b).frameElement,
domUtils.on(b,"beforedeactivate",function(){a._bakIERange=a.getIERange()}),domUtils.on(b,"activate",function(){try{!d(a)&&a._bakIERange&&a._bakIERange.select()}catch(b){}a._bakIERange=null}));b=b=null}).prototype={getNative:function(){var b=this.document;return!b?null:ie?b.selection:domUtils.getWindow(b).getSelection()},getIERange:function(){var b=d(this);return!b&&this._bakIERange?this._bakIERange:b},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();
this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var b=this.getStart();return b?domUtils.findParents(b,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return browser.ie&&d(this)||!browser.ie&&this.getNative().rangeCount?!0:!1},getRange:function(){function b(f){for(var e=a.document.body.firstChild,d=f.collapsed;e&&
e.firstChild;)f.setStart(e,0),e=e.firstChild;f.startContainer||f.setStart(a.document.body,0);d&&f.collapse(!0)}var a=this;if(null!=a._cachedRange)return this._cachedRange;var d=new baidu.editor.dom.Range(a.document);if(ie){var e=a.getIERange();e?c(e,d):b(d)}else{var f=a.getNative();if(f&&f.rangeCount)e=f.getRangeAt(0),f=f.getRangeAt(f.rangeCount-1),d.setStart(e.startContainer,e.startOffset).setEnd(f.endContainer,f.endOffset),d.collapsed&&(domUtils.isBody(d.startContainer)&&!d.startOffset)&&b(d);else{if(this._bakRange&&
domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;b(d)}}return this._bakRange=d},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var b=ie?this.getIERange():this.getRange(),a,d;if(ie){if(!b)return this.document.body.firstChild;if(b.item)return b.item(0);a=b.duplicate();0<a.text.length&&a.moveStart("character",1);a.collapse(1);a=a.parentElement();for(d=b=b.parentElement();b=b.parentNode;)if(b==a){a=d;break}}else if(b.shrinkBoundary(),a=
b.startContainer,1==a.nodeType&&a.hasChildNodes()&&(a=a.childNodes[Math.min(a.childNodes.length-1,b.startOffset)]),3==a.nodeType)return a.parentNode;return a},getText:function(){if(this.isFocus()){var b=this.getNative(),b=browser.ie?b.createRange():b.getRangeAt(0);return b.text||b.toString()}return""}}})();(function(){function b(a){for(var b=a.getElementsByTagName("img"),e,f=0,d;d=b[f++];)if(e=d.getAttribute("orgSrc"))d.src=e,d.removeAttribute("orgSrc");a=a.getElementsByTagName("a");for(f=0;b=a[f++];f++)b.getAttribute("data_ue_src")&&b.setAttribute("href",b.getAttribute("data_ue_src"))}var c=0,d,g=UE.Editor=function(a){this.uid=c++;EventBase.call(this);this.commands={};this.options=utils.extend(a||{},UEDITOR_CONFIG,!0);for(var b in UE.plugins)UE.plugins[b].call(this)};g.prototype={destroy:function(){this.fireEvent("destroy");
this.container.innerHTML="";domUtils.remove(this.container)},render:function(a){a.constructor===String&&(a=document.getElementById(a));a&&(a.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%"  frameborder="0"></iframe>',a.style.overflow="hidden",this._setup(a.firstChild.contentWindow.document))},_setup:function(a){var b=this.options,e=this;!browser.webkit&&a.open();var f=ie&&9>browser.version;a.write((ie&&9>browser.version?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"'+
(!f?' class="view"':"")+"><head>"+(b.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+utils.unhtml(/^http/.test(b.iframeCssUrl)?b.iframeCssUrl:b.UEDITOR_HOME_URL+b.iframeCssUrl)+'"/>':"")+'<style type="text/css">'+(b.initialStyle||" ")+"</style></head><body"+(f?' class="view"':"")+"></body></html>");!browser.webkit&&a.close();ie?(a.body.disabled=!0,a.body.contentEditable=!0,a.body.disabled=!1):(a.body.contentEditable=!0,a.body.spellcheck=!1);this.document=a;this.window=a.defaultView||
a.parentWindow;this.iframe=this.window.frameElement;this.body=a.body;this.options.minFrameHeight&&(this.setHeight(this.options.minFrameHeight),this.body.style.height=this.options.minFrameHeight);this.selection=new dom.Selection(a);browser.gecko&&this.selection.getNative().removeAllRanges();this._initEvents();if(e.options.initialContent)if(e.options.autoClearinitialContent){var d=e.execCommand;e.execCommand=function(){e.fireEvent("firstBeforeExecCommand");d.apply(e,arguments)};this.setDefaultContent(this.options.initialContent)}else this.setContent(this.options.initialContent,
!0);for(a=this.iframe.parentNode;!domUtils.isBody(a);a=a.parentNode)if("FORM"==a.tagName){domUtils.on(a,"submit",function(){var a=document.getElementById("ueditor_textarea_"+e.options.textarea);if(!a){a=document.createElement("textarea");a.setAttribute("name",e.options.textarea);a.id="ueditor_textarea_"+e.options.textarea;a.style.display="none";this.appendChild(a)}a.value=e.getContent()});break}domUtils.isEmptyNode(e.body)&&(this.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>");e.options.focus&&
setTimeout(function(){e.focus();!e.options.autoClearinitialContent&&e._selectionChange()});this.container||(this.container=this.iframe.parentNode);e.options.fullscreen&&e.ui&&e.ui.setFullScreen(!0);this.fireEvent("ready");if(!browser.ie)domUtils.on(e.window,"blur",function(){e._bakRange=e.selection.getRange();e.selection.getNative().removeAllRanges()});browser.gecko&&10902>=browser.version&&(e.body.contentEditable=!1,setTimeout(function(){e.body.contentEditable=true},100),setInterval(function(){e.body.style.height=
e.iframe.offsetHeight-20+"px"},100))},sync:function(a){function b(a){var d=document.getElementById("ueditor_textarea_"+e.options.textarea);d||(d=document.createElement("textarea"),d.setAttribute("name",e.options.textarea),d.id="ueditor_textarea_"+e.options.textarea,d.style.display="none",a.appendChild(d));d.value=e.getContent()}var e=this;if(a)(a=document.getElementById(a))&&b(a);else for(a=e.iframe.parentNode;!domUtils.isBody(a);a=a.parentNode)if("FORM"==a.tagName){b(a);break}},setHeight:function(a){a!==
parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=a+"px");browser.ie&&9==browser.version&&(this.document.body.style.height=a-20+"px")},getContent:function(a){this.fireEvent("beforegetcontent",a);var b=this.document.body.innerHTML.replace(RegExp(domUtils.fillChar,"g"),"").replace(/>[\t\r\n]*?</g,"><");this.fireEvent("aftergetcontent",a);this.serialize&&(a=this.serialize.parseHTML(b),a=this.serialize.transformOutput(a),b=this.serialize.toHTML(a));return b},getContentTxt:function(){return this.body[browser.ie?
"innerText":"textContent"].replace(RegExp(domUtils.fillChar,"g"),"")},setContent:function(a,d){var e=utils.extend({a:1,A:1},dtd.$inline,!0),f,a=a.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(a,b,i){b?f=i:b=f;return!e[b]&&!e[i]?a.replace(/>[ \t\r\n]*?</,"><"):a});this.fireEvent("beforesetcontent");var j=this.serialize;if(j)var i=j.parseHTML(a),i=j.transformInput(i),i=j.filter(i),a=j.toHTML(i);this.document.body.innerHTML=
a.replace(RegExp("[\r"+domUtils.fillChar+"]*","g"),"");browser.ie&&(7>browser.version&&this.options.relativePath)&&b(this.document.body);if("p"==this.options.enterTag){var j=this.body.firstChild,i=this.document.createElement("p"),c;if(!j||1==j.nodeType&&dtd.$cdata[j.tagName])this.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"+this.body.innerHTML;else for(;j;)3==j.nodeType||1==j.nodeType&&dtd.p[j.tagName]?(c=j.nextSibling,i.appendChild(j),(j=c)||this.body.appendChild(i)):(i.firstChild&&(this.body.insertBefore(i,
j),i=this.document.createElement("p")),j=j.nextSibling)}this.adjustTable&&this.adjustTable(this.body);this.fireEvent("aftersetcontent");this.fireEvent("contentchange");!d&&this._selectionChange();this._bakRange=this._bakIERange=null;browser.gecko&&this.selection.getNative().removeAllRanges()},focus:function(){try{this.selection.getRange().select(!0)}catch(a){}},_initEvents:function(){var a=this,b=a.document,e=a.window;a._proxyDomEvent=utils.bind(a._proxyDomEvent,a);domUtils.on(b,"click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart".split(" "),
a._proxyDomEvent);domUtils.on(e,["focus","blur"],a._proxyDomEvent);domUtils.on(b,["mouseup","keydown"],function(b){"keydown"==b.type&&(b.ctrlKey||b.metaKey||b.shiftKey||b.altKey)||2!=b.button&&a._selectionChange(250,b)});var f=0,b=browser.ie?a.body:a.document,d;domUtils.on(b,"dragstart",function(){f=1});domUtils.on(b,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(d);d=setTimeout(function(){if(!f){var b=a.selection.getRange();if(b&&(b=b.getCommonAncestor())&&
a.serialize){var e=a.serialize,d=e.filter(e.transformInput(e.parseHTML(e.word(b.innerHTML))));b.innerHTML=e.toHTML(d)}}f=0},200)}:function(a){f||(a.preventDefault?a.preventDefault():a.returnValue=!1);f=0}}())},_proxyDomEvent:function(a){return this.fireEvent(a.type.replace(/^on/,""),a)},_selectionChange:function(a,b){var e=this;if(e.selection.isFocus()){var f=!1,c,i;browser.ie&&(9>browser.version&&b&&"mouseup"==b.type)&&!this.selection.getRange().collapsed&&(f=!0,c=b.clientX,i=b.clientY);clearTimeout(d);
d=setTimeout(function(){if(e.selection.getNative()){var a;if(f&&e.selection.getNative().type=="None"){a=e.document.body.createTextRange();try{a.moveToPoint(c,i)}catch(d){a=null}}var g;if(a){g=e.selection.getIERange;e.selection.getIERange=function(){return a}}e.selection.cache();if(g)e.selection.getIERange=g;if(e.selection._cachedRange&&e.selection._cachedStartElement){e.fireEvent("beforeselectionchange");e.fireEvent("selectionchange",!!b);e.fireEvent("afterselectionchange");e.selection.clear()}}},
a||50)}},_callCmdFn:function(a,b){var e=b[0].toLowerCase(),f,e=(f=this.commands[e])&&f[a]||(f=UE.commands[e])&&f[a];if(f&&!e&&"queryCommandState"==a)return!1;if(e)return e.apply(this,b)},execCommand:function(a){var a=a.toLowerCase(),b,e=this.commands[a]||UE.commands[a];if(e&&e.execCommand)return!e.notNeedUndo&&!this.__hasEnterExecCommand?(this.__hasEnterExecCommand=!0,-1!=this.queryCommandState(a)&&(this.fireEvent("beforeexeccommand",a),b=this._callCmdFn("execCommand",arguments),this.fireEvent("afterexeccommand",
a)),this.__hasEnterExecCommand=!1):b=this._callCmdFn("execCommand",arguments),this._selectionChange(),b},queryCommandState:function(a){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(a){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(a){if(a)for(var b=0,e;e=a[b++];)if(0<this.document.getElementsByTagName(e).length)return!0;return!domUtils.isEmptyBlock(this.body)?!0:!1},reset:function(){this.fireEvent("reset")},setDefaultContent:function(){function a(){var b=
this;if(b.document.getElementById("initContent")){b.document.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";var e=b.selection.getRange();b.removeListener("firstBeforeExecCommand",a);b.removeListener("focus",a);setTimeout(function(){e.setStart(b.document.body.firstChild,0).collapse(!0).select(!0);b._selectionChange()})}}return function(d){this.document.body.innerHTML='<p id="initContent">'+d+"</p>";browser.ie&&(7>browser.version&&this.options.relativePath)&&b(this.document.body);this.addListener("firstBeforeExecCommand",
a);this.addListener("focus",a)}}()};utils.inherits(g,EventBase)})();UE.ajax=function(){function b(b){var c=[],a;for(a in b)"method"==a||"timeout"==a||"async"==a||"function"==(typeof b[a]).toLowerCase()||"object"==(typeof b[a]).toLowerCase()||c.push(encodeURIComponent(a)+"="+encodeURIComponent(b[a]));return c.join("&")}function c(){var b=null;if(window.XMLHttpRequest)b=new XMLHttpRequest;else try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}return b}return{request:function(d,g){var a=c(),h=!1,e={method:"POST",
timeout:5E3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};"object"===typeof d&&(g=d,d=g.url);if(a&&d){var f=g?utils.extend(e,g):e,e=b(f);utils.isEmptyObject(f.data)||(e+=(e?"&":"")+b(f.data));var j=setTimeout(function(){if(a.readyState!=4){h=true;a.abort();clearTimeout(j)}},f.timeout),i=f.method.toUpperCase(),m=d+(-1==d.indexOf("?")?"?":"&")+("POST"==i?"":e)+"&noCache="+ +new Date;a.open(i,m,f.async);a.onreadystatechange=function(){if(a.readyState==4)if(!h&&a.status==200)f.onsuccess(a);
else f.onerror(a)};"POST"==i?(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(e)):a.send(null)}}}}();UE.commands.inserthtml={execCommand:function(b,c){var d=this,g,a,h,e=d.currentSelectedArr;g=d.selection.getRange();h=g.document.createElement("div");h.style.display="inline";h.innerHTML=utils.trim(c);try{d.adjustTable&&d.adjustTable(h)}catch(f){}if(e&&e.length){a=0;for(var j;j=e[a++];)j.className="";e[0].innerHTML="";g.setStart(e[0],0).collapse(!0);d.currentSelectedArr=[]}if(!g.collapsed&&(g.deleteContents(),1==g.startContainer.nodeType)){a=g.startContainer.childNodes[g.startOffset];var i;if(a&&domUtils.isBlockElm(a)&&
(i=a.previousSibling)&&domUtils.isBlockElm(i)){for(g.setEnd(i,i.childNodes.length).collapse();a.firstChild;)i.appendChild(a.firstChild);domUtils.remove(a)}}for(var m,e=0;a=h.firstChild;){g.insertNode(a);if(!e&&a.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(a)&&(j=domUtils.findParent(a,function(a){return domUtils.isBlockElm(a)}))&&"body"!=j.tagName.toLowerCase()&&!(dtd[j.tagName][a.nodeName]&&a.parentNode===j)){if(dtd[j.tagName][a.nodeName])for(m=a.parentNode;m!==j;)i=m,m=m.parentNode;else i=
j;domUtils.breakParent(a,i||m);i=a.previousSibling;domUtils.trimWhiteTextNode(i);i.childNodes.length||domUtils.remove(i);e=1}j=a.nextSibling;if(!h.firstChild&&j&&domUtils.isBlockElm(j)){g.setStart(j,0).collapse(!0);break}g.setEndAfter(a).collapse()}a=g.startContainer;domUtils.isBlockElm(a)&&domUtils.isEmptyNode(a)&&(a.innerHTML=browser.ie?"":"<br/>");g.select(!0);setTimeout(function(){g=d.selection.getRange();g.scrollToView(d.autoHeightEnabled,d.autoHeightEnabled?domUtils.getXY(d.iframe).y:0)},200)}};UE.plugins.autotypeset=function(){function b(a,b){if(a&&a.parentNode&&f[a.tagName.toLowerCase()])return j&&j.contains(a)||a.getAttribute("pagebreak")?0:b?!domUtils.isEmptyBlock(a):domUtils.isEmptyBlock(a)}function c(a){a.style.cssText||(domUtils.removeAttributes(a,["style"]),"span"==a.tagName.toLowerCase()&&domUtils.hasNoAttributes(a)&&domUtils.remove(a,!0))}function d(f,d){if(browser.ie)try{var l=g.serialize;if(l){var k=l.parseHTML(d.html),k=l.transformInput(k),k=l.filter(k);d.html=l.toHTML(k)}}catch(n){}if(d){if(!a.pasteFilter)return;
l=g.document.createElement("div");l.innerHTML=d.html}else l=g.document.body;for(var k=domUtils.getElementsByTagName(l,"*"),t=0,q;q=k[t++];){!j&&("DIV"==q.tagName&&q.getAttribute("highlighter"))&&(j=q);a.clearFontSize&&q.style.fontSize&&(q.style.fontSize="",c(q));a.clearFontFamily&&q.style.fontFamily&&(q.style.fontFamily="",c(q));if(b(q)){if(a.mergeEmptyline)for(var o=q.nextSibling,s;b(o);)s=o,o=s.nextSibling,domUtils.remove(s);if(a.removeEmptyline&&domUtils.inDoc(q,l)&&!e[q.parentNode.tagName.toLowerCase()]){domUtils.remove(q);
continue}}if(b(q,!0)&&(a.indent&&(q.style.textIndent=a.indentValue),a.textAlign))q.style.textAlign=a.textAlign;if(a.removeClass&&q.className&&!h[q.className.toLowerCase()]){if(j&&j.contains(q))continue;domUtils.removeAttributes(q,["class"])}if(a.imageBlockLine&&"img"==q.tagName.toLowerCase()&&!q.getAttribute("emotion"))if(d){var r=q;switch(a.imageBlockLine){case "left":case "right":case "none":for(var o=r.parentNode,u;dtd.$inline[o.tagName]||"A"==o.tagName;)o=o.parentNode;s=o;if("P"==s.tagName&&"center"==
domUtils.getStyle(s,"text-align")&&!domUtils.isBody(s)&&1==domUtils.getChildCount(s,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)}))if(u=s.previousSibling,o=s.nextSibling,u&&o&&1==u.nodeType&&1==o.nodeType&&u.tagName==o.tagName&&domUtils.isBlockElm(u)){for(u.appendChild(s.firstChild);o.firstChild;)u.appendChild(o.firstChild);domUtils.remove(s);domUtils.remove(o)}else domUtils.setStyle(s,"text-align","");domUtils.setStyle(r,"float",a.imageBlockLine);break;case "center":if("center"!=
g.queryCommandValue("imagefloat")){o=r.parentNode;domUtils.setStyle(r,"float","none");for(s=r;o&&1==domUtils.getChildCount(o,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)})&&(dtd.$inline[o.tagName]||"A"==o.tagName);)s=o,o=o.parentNode;r=g.document.createElement("p");domUtils.setAttributes(r,{style:"text-align:center"});s.parentNode.insertBefore(r,s);r.appendChild(s);domUtils.setStyle(s,"float","")}}}else g.selection.getRange().selectNode(q).select(),g.execCommand("imagefloat",a.imageBlockLine);
a.removeEmptyNode&&a.removeTagNames[q.tagName.toLowerCase()]&&(domUtils.hasNoAttributes(q)&&domUtils.isEmptyBlock(q))&&domUtils.remove(q)}d&&(d.html=l.innerHTML)}if(this.options.autotypeset){var g=this,a=g.options.autotypeset,h={selectTdClass:1,pagebreak:1,anchorclass:1},e={li:1},f={div:1,p:1},j;a.pasteFilter&&g.addListener("beforepaste",d);g.commands.autotypeset={execCommand:function(){g.removeListener("beforepaste",d);a.pasteFilter&&g.addListener("beforepaste",d);d()}}}};UE.commands.imagefloat={execCommand:function(b,c){var d=this.selection.getRange();if(!d.collapsed){var g=d.getClosedNode();if(g&&"IMG"==g.tagName)switch(c){case "left":case "right":case "none":for(var a=g.parentNode,h,e;dtd.$inline[a.tagName]||"A"==a.tagName;)a=a.parentNode;h=a;if("P"==h.tagName&&"center"==domUtils.getStyle(h,"text-align")){if(!domUtils.isBody(h)&&1==domUtils.getChildCount(h,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)}))if(a=h.previousSibling,e=h.nextSibling,a&&
e&&1==a.nodeType&&1==e.nodeType&&a.tagName==e.tagName&&domUtils.isBlockElm(a)){for(a.appendChild(h.firstChild);e.firstChild;)a.appendChild(e.firstChild);domUtils.remove(h);domUtils.remove(e)}else domUtils.setStyle(h,"text-align","");d.selectNode(g).select()}domUtils.setStyle(g,"float",c);break;case "center":if("center"!=this.queryCommandValue("imagefloat")){a=g.parentNode;domUtils.setStyle(g,"float","none");for(h=g;a&&1==domUtils.getChildCount(a,function(a){return!domUtils.isBr(a)&&!domUtils.isWhitespace(a)})&&
(dtd.$inline[a.tagName]||"A"==a.tagName);)h=a,a=a.parentNode;d.setStartBefore(h).setCursor(!1);a=this.document.createElement("div");a.appendChild(h);domUtils.setStyle(h,"float","");this.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+a.innerHTML+"</p>");h=this.document.getElementById("_img_parent_tmp");h.removeAttribute("id");h=h.firstChild;d.selectNode(h).select();(e=h.parentNode.nextSibling)&&domUtils.isEmptyNode(e)&&domUtils.remove(e)}}}},queryCommandValue:function(){var b=
this.selection.getRange(),c;return b.collapsed?"none":(b=b.getClosedNode())&&1==b.nodeType&&"IMG"==b.tagName?(c=domUtils.getComputedStyle(b,"float"),"none"==c&&(c="center"==domUtils.getComputedStyle(b.parentNode,"text-align")?"center":c),{left:1,right:1,center:1}[c]?c:"none"):"none"},queryCommandState:function(){if(this.highlight)return-1;var b=this.selection.getRange();return b.collapsed?-1:(b=b.getClosedNode())&&1==b.nodeType&&"IMG"==b.tagName?0:-1}};
UE.commands.insertimage={execCommand:function(b,c){c=utils.isArray(c)?c:[c];if(c.length){var d=this.selection.getRange(),g=d.getClosedNode();if(g&&/img/i.test(g.tagName)&&"edui-faked-video"!=g.className&&!g.getAttribute("word_img")){var a=c.shift(),h=a.floatStyle;delete a.floatStyle;domUtils.setAttributes(g,a);this.execCommand("imagefloat",h);0<c.length&&(d.setStartAfter(g).setCursor(!1,!0),this.execCommand("insertimage",c))}else{d=[];g="";a=c[0];if(1==c.length)g='<img src="'+a.src+'" '+(a.data_ue_src?
' data_ue_src="'+a.data_ue_src+'" ':"")+(a.width?'width="'+a.width+'" ':"")+(a.height?' height="'+a.height+'" ':"")+(a.floatStyle&&"center"!=a.floatStyle?' style="float:'+a.floatStyle+';"':"")+(a.title?' title="'+a.title+'"':"")+' border="'+(a.border||0)+'" hspace = "'+(a.hspace||0)+'" vspace = "'+(a.vspace||0)+'" />',"center"==a.floatStyle&&(g='<p style="text-align: center">'+g+"</p>"),d.push(g);else for(h=0;a=c[h++];)g="<p "+("center"==a.floatStyle?'style="text-align: center" ':"")+'><img src="'+
a.src+'" '+(a.width?'width="'+a.width+'" ':"")+(a.data_ue_src?' data_ue_src="'+a.data_ue_src+'" ':"")+(a.height?' height="'+a.height+'" ':"")+' style="'+(a.floatStyle&&"center"!=a.floatStyle?"float:"+a.floatStyle+";":"")+(a.border||"")+'" '+(a.title?' title="'+a.title+'"':"")+" /></p>",d.push(g);this.execCommand("insertHtml",d.join(""))}}},queryCommandState:function(){return this.highlight?-1:0}};(function(){var b={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"},c;for(c in b)(function(b,c){UE.commands[b]={execCommand:function(a,h){var h=h||(this.queryCommandState(a)?"none":"underline"==a?"underline":"line-through"),e=this.selection.getRange(),f;if("default"==h){if(e.collapsed&&(f=this.document.createTextNode("font"),e.insertNode(f).select()),this.execCommand("removeFormat","span,a",c),
f)e.setStartBefore(f).setCursor(),domUtils.remove(f)}else if(this.currentSelectedArr&&0<this.currentSelectedArr.length){f=0;for(var j;j=this.currentSelectedArr[f++];)e.selectNodeContents(j),e.applyInlineStyle("span",{style:c+":"+h});e.selectNodeContents(this.currentSelectedArr[0]).select()}else if(e.collapsed){j=domUtils.findParentByTagName(e.startContainer,"span",!0);f=this.document.createTextNode("font");if(j&&!j.children.length&&!j[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){e.insertNode(f);
if("underline"==b||"strikethrough"==b)e.selectNode(f).select(),this.execCommand("removeFormat","span,a",c,null),j=domUtils.findParentByTagName(f,"span",!0),e.setStartBefore(f);j.style.cssText=j.style.cssText+";"+c+":"+h;e.collapse(!0).select()}else{e.insertNode(f);e.selectNode(f).select();j=e.document.createElement("span");if("underline"==b||"strikethrough"==b){if(domUtils.findParentByTagName(f,"a",!0)){e.setStartBefore(f).setCursor();domUtils.remove(f);return}this.execCommand("removeFormat","span,a",
c)}j.style.cssText=c+":"+h;f.parentNode.insertBefore(j,f);if(!browser.ie||browser.ie&&9==browser.version)for(var i=j.parentNode;!domUtils.isBlockElm(i);)"SPAN"==i.tagName&&(j.style.cssText=i.style.cssText+j.style.cssText),i=i.parentNode;e.setStart(j,0).setCursor()}domUtils.remove(f)}else("underline"==b||"strikethrough"==b)&&this.queryCommandValue(b)&&this.execCommand("removeFormat","span,a",c),e=this.selection.getRange(),e.applyInlineStyle("span",{style:c+":"+h}).select();return!0},queryCommandValue:function(a){var b=
this.selection.getStart();if("underline"==a||"strikethrough"==a){for(a=b;a&&!domUtils.isBlockElm(a)&&!domUtils.isBody(a);){if(1==a.nodeType&&(b=domUtils.getComputedStyle(a,c),"none"!=b))return b;a=a.parentNode}return"none"}return domUtils.getComputedStyle(b,c)},queryCommandState:function(a){return this.highlight?-1:!("underline"==a||"strikethrough"==a)?0:this.queryCommandValue(a)==("underline"==a?"underline":"line-through")}}})(c,b[c])})();(function(){function b(b){var c=b.startContainer,a=b.endContainer;(c=domUtils.findParentByTagName(c,"a",!0))&&b.setStartBefore(c);(a=domUtils.findParentByTagName(a,"a",!0))&&b.setEndAfter(a)}function c(d,c){b(d=d.adjustmentBoundary());var a=d.startContainer;if(1==a.nodeType&&(a=a.childNodes[d.startOffset])&&1==a.nodeType&&"A"==a.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(a[browser.ie?"innerText":"textContent"]))a.innerHTML=c.href;d.removeInlineStyle("a");d.collapsed?(a=d.document.createElement("a"),
domUtils.setAttributes(a,c),a.innerHTML=c.href,d.insertNode(a).selectNode(a)):d.applyInlineStyle("a",c)}UE.commands.unlink={execCommand:function(){var d,c=new dom.Range(this.document),a=this.currentSelectedArr;if(a&&0<a.length){for(var h=0;d=a[h++];){d=domUtils.getElementsByTagName(d,"a");for(var e=0,f;f=d[e++];)domUtils.remove(f,!0)}domUtils.isEmptyNode(a[0])?c.setStart(a[0],0).setCursor():c.selectNodeContents(a[0]).select()}else if(c=this.selection.getRange(),!c.collapsed||domUtils.findParentByTagName(c.startContainer,
"a",!0))a=c.createBookmark(),b(c),c.removeInlineStyle("a").moveToBookmark(a).select()},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};UE.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(b,g){var a=new dom.Range(this.document),h=this.currentSelectedArr;if(h&&h.length){for(var e=0,f;f=h[e++];)domUtils.isEmptyNode(f)&&(f.innerHTML=g.href),c(a.selectNodeContents(f),g);a.selectNodeContents(h[0]).select()}else c(a=this.selection.getRange(),
g),a.collapse().select(browser.gecko?!0:!1)},queryCommandValue:function(){var b=new dom.Range(this.document),c=this.currentSelectedArr,a,h;if(c&&c.length)for(var b=0,e;e=c[b++];){if(a=e.getElementsByTagName("a"),a[0])return a[0]}else if(b=this.selection.getRange(),b.collapsed){if((h=this.selection.getStart())&&(h=domUtils.findParentByTagName(h,"a",!0)))return h}else{b.shrinkBoundary();c=3==b.startContainer.nodeType||!b.startContainer.childNodes[b.startOffset]?b.startContainer:b.startContainer.childNodes[b.startOffset];
e=3==b.endContainer.nodeType||0==b.endOffset?b.endContainer:b.endContainer.childNodes[b.endOffset-1];b=b.getCommonAncestor();h=domUtils.findParentByTagName(b,"a",!0);if(!h&&1==b.nodeType){a=b.getElementsByTagName("a");for(var f,j,b=0,i;i=a[b++];)if(f=domUtils.getPosition(i,c),j=domUtils.getPosition(i,e),(f&domUtils.POSITION_FOLLOWING||f&domUtils.POSITION_CONTAINS)&&(j&domUtils.POSITION_PRECEDING||j&domUtils.POSITION_CONTAINS)){h=i;break}}return h}}}})();UE.commands.removeformat={execCommand:function(b,c,d,g,a){function h(a){if(3==a.nodeType||"span"!=a.tagName.toLowerCase())return 0;if(browser.ie){var b=a.attributes;if(b.length){for(var a=0,f=b.length;a<f;a++)if(b[a].specified)return 0;return 1}}return!a.attributes.length}function e(b){var e=b.createBookmark();b.collapsed&&b.enlarge(!0);if(!a){var c=domUtils.findParentByTagName(b.startContainer,"a",!0);c&&b.setStartBefore(c);(c=domUtils.findParentByTagName(b.endContainer,"a",!0))&&b.setEndAfter(c)}i=
b.createBookmark();for(c=i.start;(m=c.parentNode)&&!domUtils.isBlockElm(m);)domUtils.breakParent(c,m),domUtils.clearEmptySibling(c);if(i.end){for(c=i.end;(m=c.parentNode)&&!domUtils.isBlockElm(m);)domUtils.breakParent(c,m),domUtils.clearEmptySibling(c);for(var c=domUtils.getNextDomNode(i.start,!1,l),g;c&&c!=i.end;)g=domUtils.getNextDomNode(c,!0,l),!dtd.$empty[c.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(c)&&(f.test(c.tagName)?d?(domUtils.removeStyle(c,d),h(c)&&"text-decoration"!=d&&domUtils.remove(c,
!0)):domUtils.remove(c,!0):!dtd.$tableContent[c.tagName]&&!dtd.$list[c.tagName]&&(domUtils.removeAttributes(c,j),h(c)&&domUtils.remove(c,!0))),c=g}c=i.start.parentNode;domUtils.isBlockElm(c)&&(!dtd.$tableContent[c.tagName]&&!dtd.$list[c.tagName])&&domUtils.removeAttributes(c,j);c=i.end.parentNode;i.end&&(domUtils.isBlockElm(c)&&!dtd.$tableContent[c.tagName]&&!dtd.$list[c.tagName])&&domUtils.removeAttributes(c,j);b.moveToBookmark(i).moveToBookmark(e);c=b.startContainer;for(g=b.collapsed;1==c.nodeType&&
domUtils.isEmptyNode(c)&&dtd.$removeEmpty[c.tagName];)e=c.parentNode,b.setStartBefore(c),b.startContainer===b.endContainer&&b.endOffset--,domUtils.remove(c),c=e;if(!g)for(c=b.endContainer;1==c.nodeType&&domUtils.isEmptyNode(c)&&dtd.$removeEmpty[c.tagName];)e=c.parentNode,b.setEndBefore(c),domUtils.remove(c),c=e}var f=RegExp("^(?:"+(c||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),j=d?[]:(g||this.options.removeFormatAttributes).split(","),b=new dom.Range(this.document),i,m,l=function(a){return 1==
a.nodeType};if(this.currentSelectedArr&&this.currentSelectedArr.length){for(c=0;g=this.currentSelectedArr[c++];)b.selectNodeContents(g),e(b);b.selectNodeContents(this.currentSelectedArr[0]).select()}else b=this.selection.getRange(),e(b),b.select()},queryCommandState:function(){return this.highlight?-1:0}};(function(){UE.commands.blockquote={execCommand:function(b,c){var d=this.selection.getRange(),g=utils.findNode(this.selection.getStartElementPath(),["blockquote"]),a=dtd.blockquote,h=d.createBookmark(),e=this.currentSelectedArr;if(g)if(e&&e.length)domUtils.remove(g,!0);else{a=d.startContainer;a=domUtils.isBlockElm(a)?a:domUtils.findParent(a,function(a){return domUtils.isBlockElm(a)});e=d.endContainer;e=domUtils.isBlockElm(e)?e:domUtils.findParent(e,function(a){return domUtils.isBlockElm(a)});a=domUtils.findParentByTagName(a,
"li",!0)||a;e=domUtils.findParentByTagName(e,"li",!0)||e;"LI"==a.tagName||"TD"==a.tagName||a===g?domUtils.remove(g,!0):domUtils.breakParent(a,g);a!==e&&(g=domUtils.findParentByTagName(e,"blockquote"))&&("LI"==e.tagName||"TD"==e.tagName?domUtils.remove(g,!0):domUtils.breakParent(e,g));for(var f=domUtils.getElementsByTagName(this.document,"blockquote"),g=0,j;j=f[g++];)j.childNodes.length?domUtils.getPosition(j,a)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(j,e)&domUtils.POSITION_PRECEDING&&domUtils.remove(j,
!0):domUtils.remove(j)}else{g=d.cloneRange();f=e=1==g.startContainer.nodeType?g.startContainer:g.startContainer.parentNode;for(j=1;;){if(domUtils.isBody(e)){f!==e?d.collapsed?(g.selectNode(f),j=0):g.setStartBefore(f):g.setStart(e,0);break}if(!a[e.tagName]){d.collapsed?g.selectNode(f):g.setStartBefore(f);break}f=e;e=e.parentNode}if(j)for(f=e=e=1==g.endContainer.nodeType?g.endContainer:g.endContainer.parentNode;;){if(domUtils.isBody(e)){f!==e?g.setEndAfter(f):g.setEnd(e,e.childNodes.length);break}if(!a[e.tagName]){g.setEndAfter(f);
break}f=e;e=e.parentNode}e=d.document.createElement("blockquote");domUtils.setAttributes(e,c);e.appendChild(g.extractContents());g.insertNode(e);a=domUtils.getElementsByTagName(e,"blockquote");for(g=0;e=a[g++];)e.parentNode&&domUtils.remove(e,!0)}d.moveToBookmark(h).select()},queryCommandState:function(){return this.highlight?-1:utils.findNode(this.selection.getStartElementPath(),["blockquote"])?1:0}}})();UE.plugins.undo=function(){function b(a){this.collapsed=a.collapsed;this.startAddr=c(a.startContainer,a.startOffset);this.endAddr=a.collapsed?this.startAddr:c(a.endContainer,a.endOffset)}function c(a,b){for(var f=0,e=[b],i,d=domUtils.findParents(a,!0,function(a){return!domUtils.isBody(a)},!0);i=d[f++];){if(1==f&&3==i.nodeType){for(var c=i;c=c.previousSibling;)if(3==c.nodeType)b+=c.nodeValue.replace(fillCharReg,"").length;else break;e[0]=b}e.push(domUtils.getNodeIndex(i,!0))}return e.reverse()}function d(a,
b){if(a.length!=b.length)return 0;for(var f=0,e=a.length;f<e;f++)if(a[f]!=b[f])return 0;return 1}function g(a,b,f){for(var e=a.document.body,i=0,e,d=f.length-1;i<d;i++)e=e.childNodes[f[i]];a[b+"Container"]=e;a[b+"Offset"]=f[f.length-1]}function a(){this.undoManger.save()}var h=this,e=h.options.maxUndoCount||20,f=h.options.maxInputCount||20,j=RegExp(domUtils.fillChar+"|</hr>","gi"),i=/\b(?:href|src|name)="[^"]*?"/gi;b.prototype={compare:function(a){return h.collapsed!==a.collapsed||!d(h.startAddr,
a.startAddr)||!d(h.endAddr,a.endAddr)?0:1},transformRange:function(a){a.collapsed=this.collapsed;g(a,"start",this.startAddr);a.collapsed?a.collapse(!0):g(a,"end",this.endAddr)}};h.undoManger=new function(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=!1;this.undo=function(){if(this.hasUndo){var a=this.getScene();this.list[this.index].content.replace(i,"")!=a.content.replace(i,"")&&this.save();if(!this.list[this.index-1]&&1==this.list.length)this.reset();else{for(;this.list[this.index].content==
this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}}};this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}};this.restore=function(){var a=this.list[this.index];h.document.body.innerHTML=a.bookcontent.replace(j,"");if(browser.ie)for(var b=0,f,e=h.document.getElementsByTagName("p");f=
e[b++];)""==f.innerHTML&&domUtils.fillNode(h.document,f);var i=new dom.Range(h.document);try{browser.opera||browser.safari?a.senceRange.transformRange(i):i.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:!0}),browser.ie&&(9==browser.version&&i.collapsed&&domUtils.isBlockElm(i.startContainer)&&domUtils.isEmptyNode(i.startContainer))&&domUtils.fillNode(i.document,i.startContainer),i.select(!browser.gecko),!browser.opera&&!browser.safari&&setTimeout(function(){i.scrollToView(h.autoHeightEnabled,
h.autoHeightEnabled?domUtils.getXY(h.iframe).y:0)},200)}catch(d){}this.update();if(h.currentSelectedArr){h.currentSelectedArr=[];a=h.document.getElementsByTagName("td");for(b=0;f=a[b++];)f.className==h.options.selectedTdClass&&h.currentSelectedArr.push(f)}this.clearKey();h.fireEvent("reset",!0)};this.getScene=function(){var a=h.selection.getRange(),f=h.body.innerHTML.replace(j,"");a.shrinkBoundary();browser.ie&&(f=f.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));if(browser.opera||
browser.safari)return{senceRange:new b(a),content:f,bookcontent:f};var e=a.createBookmark(!0,!0),i=h.body.innerHTML.replace(j,"");e&&a.moveToBookmark(e).select(!0);return{bookcontent:i,content:f}};this.save=function(){var a=this.getScene(),b=this.list[this.index];if(!b||!(b.content==a.content&&(browser.opera||browser.safari?b.senceRange.compare(a.senceRange):b.bookcontent==a.bookcontent)))this.list=this.list.slice(0,this.index+1),this.list.push(a),this.list.length>e&&this.list.shift(),this.index=
this.list.length-1,this.clearKey(),this.update()};this.update=function(){this.hasRedo=this.list[this.index+1]?!0:!1;this.hasUndo=this.list[this.index-1]||1==this.list.length?!0:!1};this.reset=function(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=!1;this.clearKey()};this.clearKey=function(){l=0;k=null;h.fireEvent("contentchange")}};h.addListener("beforeexeccommand",a);h.addListener("afterexeccommand",a);h.addListener("reset",function(a,b){b||h.undoManger.reset()});h.commands.redo=h.commands.undo=
{execCommand:function(a){h.undoManger[a]()},queryCommandState:function(a){return h.undoManger["has"+("undo"==a.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var m={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},l=0,k;h.addListener("keydown",function(a,b){h.saveTimer&&(h.saveTimer=window.clearTimeout(h.saveTimer));var e=b.keyCode||b.which;if((!browser.webkit||!(browser.chrome&&229==e))&&!m[e]&&!b.ctrlKey&&!b.metaKey&&!b.shiftKey&&!b.altKey)0==h.undoManger.list.length||(8==e||46==e)&&k!=e?(h.undoManger.save(!0),
k=e):(2==h.undoManger.list.length&&(0==h.undoManger.index&&0==l)&&(h.undoManger.list.splice(1,1),h.undoManger.update()),k=e,l++,l>=f&&h.selection.getRange().collapsed&&h.undoManger.save())});if(browser.webkit&&browser.chrome){h.addListener("keyup",function(a,b){h.saveTimer&&(h.saveTimer=window.clearTimeout(h.saveTimer));var f=b.keyCode||b.which;(32==f||13==f)&&h.selection.getRange().collapsed&&n()});var n=function(){h.saveTimer&&(h.saveTimer=window.clearTimeout(h.saveTimer));h.saveTimer=window.setTimeout(function(){h.undoManger.save()},
1E4)}}};(function(){function b(b){var d=this.document;if(!d.getElementById("baidu_pastebin")){var g=this.selection.getRange(),a=g.createBookmark(),h=d.createElement("div");h.id="baidu_pastebin";browser.webkit&&h.appendChild(d.createTextNode(domUtils.fillChar+domUtils.fillChar));d.body.appendChild(h);a.start.style.display="";h.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(a.start).y+"px";g.selectNodeContents(h).select(!0);setTimeout(function(){if(browser.webkit)for(var e=
0,f=d.querySelectorAll("#baidu_pastebin"),j;j=f[e++];)if(domUtils.isEmptyNode(j))domUtils.remove(j);else{h=j;break}try{h.parentNode.removeChild(h)}catch(i){}g.moveToBookmark(a).select(!0);b(h)},0)}}UE.plugins.paste=function(){function c(b){if(b.firstChild){for(var f=domUtils.getElementsByTagName(b,"span"),c=0,i;i=f[c++];)("_baidu_cut_start"==i.id||"_baidu_cut_end"==i.id)&&domUtils.remove(i);if(browser.webkit){i=b.querySelectorAll("div br");for(c=0;f=i[c++];)f=f.parentNode,"DIV"==f.tagName&&1==f.childNodes.length&&
(f.innerHTML="<p><br/></p>",domUtils.remove(f));f=b.querySelectorAll("#baidu_pastebin");for(c=0;i=f[c++];){var m=d.document.createElement("p");for(i.parentNode.insertBefore(m,i);i.firstChild;)m.appendChild(i.firstChild);domUtils.remove(i)}i=b.querySelectorAll("meta");for(c=0;f=i[c++];)domUtils.remove(f);i=b.querySelectorAll("br");for(c=0;f=i[c++];)/^apple-/.test(f)&&domUtils.remove(f)}if(browser.gecko){i=b.querySelectorAll("[_moz_dirty]");for(c=0;f=i[c++];)f.removeAttribute("_moz_dirty")}if(!browser.ie){i=
b.querySelectorAll("span.apple-style-span");for(c=0;f=i[c++];)domUtils.remove(f,!0)}b=b.innerHTML;if(c=d.serialize)try{var l=c.transformInput(c.parseHTML(c.word(b)),g),l=c.filter(l,a?{whiteList:{p:{br:1,BR:1},br:{$:{}},div:{br:1,BR:1,$:{}},li:{$:{}},tr:{td:1,$:{}},td:{$:{}}},blackList:{style:1,script:1,object:1}}:null,!a?h:null);if(browser.webkit)for(var k=l.children.length,n;(n=l.children[k-1])&&"br"==n.tag;)l.children.splice(k-1,1),k=l.children.length;b=c.toHTML(l,a)}catch(t){}b={html:b};d.fireEvent("beforepaste",
b);try{b.html&&(b.html=b.html.replace(/(<img|<img([^\/>]+?))\s+(small)?src\s*=\s*("\s*(?!http).*"|\s*(?!http)[^\s>"]+)(.*?\/?>)/gi,""),d.execCommand("insertHtml",b.html))}catch(q){}d.fireEvent("afterpaste")}}var d=this,g={flag:""},a=d.options.pasteplain,h={flag:""};d.commands.pasteplain={queryCommandState:function(){return a},execCommand:function(){a=!a|0},notNeedUndo:1};d.addListener("ready",function(){domUtils.on(d.body,"cut",function(){!d.selection.getRange().collapsed&&d.undoManger&&d.undoManger.save()});
domUtils.on(d.body,browser.ie?"keydown":"paste",function(a){(!browser.ie||a.ctrlKey&&"86"==a.keyCode)&&b.call(d,function(a){function b(){d.ui.hideToolbarMsg();d.removeListener("selectionchange",b)}c(a);h.flag&&d.ui&&(d.ui.showToolbarMsg(d.options.messages.pasteMsg,g.flag),h.flag="",setTimeout(function(){d.addListener("selectionchange",b)},100));g.flag&&(!d.queryCommandState("pasteplain")&&d.ui)&&(d.ui.showToolbarMsg(d.options.messages.pasteWordImgMsg,!0),g.flag="",setTimeout(function(){d.addListener("selectionchange",
b)},100))})})})}})();UE.plugins.list=function(){function b(b,a,c){var e=b.nextSibling;if(e&&1==e.nodeType&&e.tagName.toLowerCase()==a&&(domUtils.getStyle(e,"list-style-type")||("ol"==a?"decimal":"disc"))==c)domUtils.moveChild(e,b),0==e.childNodes.length&&domUtils.remove(e);(e=b.previousSibling)&&(1==e.nodeType&&e.tagName.toLowerCase()==a&&(domUtils.getStyle(e,"list-style-type")||("ol"==a?"decimal":"disc"))==c)&&domUtils.moveChild(b,e);0==b.childNodes.length&&domUtils.remove(b)}var c=this,d={TD:1,PRE:1,BLOCKQUOTE:1};c.addListener("keydown",
function(b,a){function d(){a.preventDefault?a.preventDefault():a.returnValue=!1;c.undoManger&&c.undoManger.save()}var e=a.keyCode||a.which;if(13==e){var f=c.selection.getRange(),j=domUtils.findParentByTagName(f.startContainer,["ol","ul"],!0,function(a){return a.tagName=="TABLE"}),i=domUtils.findParentByTagName(f.endContainer,["ol","ul"],!0,function(a){return a.tagName=="TABLE"});if(j&&i&&j===i){if(!f.collapsed)if(j=domUtils.findParentByTagName(f.startContainer,"li",!0),i=domUtils.findParentByTagName(f.endContainer,
"li",!0),j&&i&&j===i){if(f.deleteContents(),(i=domUtils.findParentByTagName(f.startContainer,"li",!0))&&domUtils.isEmptyBlock(i)){m=i.previousSibling;e=i.nextSibling;k=c.document.createElement("p");domUtils.fillNode(c.document,k);l=i.parentNode;m&&e?(f.setStart(e,0).collapse(!0).select(!0),domUtils.remove(i)):(!m&&!e||!m?l.parentNode.insertBefore(k,l):i.parentNode.parentNode.insertBefore(k,l.nextSibling),domUtils.remove(i),l.firstChild||domUtils.remove(l),f.setStart(k,0).setCursor());d();return}}else{k=
f.cloneRange();j=k.collapse(!1).createBookmark();f.deleteContents();k.moveToBookmark(j);var i=domUtils.findParentByTagName(k.startContainer,"li",!0),m=i.previousSibling,e=i.nextSibling;m&&(i=m,m.firstChild&&domUtils.isBlockElm(m.firstChild)&&(m=m.firstChild),domUtils.isEmptyNode(m)&&domUtils.remove(i));e&&(i=e,e.firstChild&&domUtils.isBlockElm(e.firstChild)&&(e=e.firstChild),domUtils.isEmptyNode(e)&&domUtils.remove(i));k.select();d();return}if(i=domUtils.findParentByTagName(f.startContainer,"li",
!0)){if(domUtils.isEmptyBlock(i)){var j=f.createBookmark(),l=i.parentNode;i!==l.lastChild?domUtils.breakParent(i,l):(l.parentNode.insertBefore(i,l.nextSibling),domUtils.isEmptyNode(l)&&domUtils.remove(l));if(!dtd.$list[i.parentNode.tagName])if(domUtils.isBlockElm(i.firstChild))domUtils.remove(i,!0);else{k=c.document.createElement("p");for(i.parentNode.insertBefore(k,i);i.firstChild;)k.appendChild(i.firstChild);domUtils.remove(i)}f.moveToBookmark(j).select()}else{k=i.firstChild;if(!k||!domUtils.isBlockElm(k)){var k=
c.document.createElement("p");for(!i.firstChild&&domUtils.fillNode(c.document,k);i.firstChild;)k.appendChild(i.firstChild);i.appendChild(k)}j=c.document.createElement("span");f.insertNode(j);domUtils.breakParent(j,i);m=j.nextSibling;k=m.firstChild;k||(k=c.document.createElement("p"),domUtils.fillNode(c.document,k),m.appendChild(k));domUtils.isEmptyNode(k)&&(k.innerHTML="",domUtils.fillNode(c.document,k));f.setStart(k,0).collapse(!0).shrinkBoundary().select();domUtils.remove(j);if((m=m.previousSibling)&&
domUtils.isEmptyBlock(m))m.innerHTML="<p></p>",domUtils.fillNode(c.document,m.firstChild)}d()}}}if(8==e&&(f=c.selection.getRange(),f.collapsed&&domUtils.isStartInblock(f)&&(k=f.cloneRange().trimBoundary(),(i=domUtils.findParentByTagName(f.startContainer,"li",!0))&&domUtils.isStartInblock(k))))if(i&&(m=i.previousSibling)){if(!(46==e&&i.childNodes.length)){dtd.$list[m.tagName]&&(m=m.lastChild);c.undoManger&&c.undoManger.save();k=i.firstChild;if(domUtils.isBlockElm(k))if(domUtils.isEmptyNode(k)){m.appendChild(k);
for(f.setStart(k,0).setCursor(!1,!0);i.firstChild;)m.appendChild(i.firstChild)}else{if((j=domUtils.findParentByTagName(f.startContainer,"p",!0))&&j!==k)return;j=c.document.createElement("span");f.insertNode(j);domUtils.moveChild(i,m);f.setStartBefore(j).collapse(!0).select(!0);domUtils.remove(j)}else if(domUtils.isEmptyNode(i))k=c.document.createElement("p"),m.appendChild(k),f.setStart(k,0).setCursor();else for(f.setEnd(m,m.childNodes.length).collapse().select(!0);i.firstChild;)m.appendChild(i.firstChild);
domUtils.remove(i);c.undoManger&&c.undoManger.save();domUtils.preventDefault(a)}}else if(i&&!i.previousSibling&&(k=i.firstChild,!k||i.lastChild===k&&domUtils.isEmptyNode(domUtils.isBlockElm(k)?k:i)))k=c.document.createElement("p"),i.parentNode.parentNode.insertBefore(k,i.parentNode),domUtils.fillNode(c.document,k),f.setStart(k,0).setCursor(),domUtils.remove(!i.nextSibling?i.parentNode:i),c.undoManger&&c.undoManger.save(),domUtils.preventDefault(a)});c.commands.insertorderedlist=c.commands.insertunorderedlist=
{execCommand:function(c,a){a||(a="insertorderedlist"==c.toLowerCase()?"decimal":"disc");var h=this.selection.getRange(),e=function(a){return 1==a.nodeType?"br"!=a.tagName.toLowerCase():!domUtils.isWhitespace(a)},f="insertorderedlist"==c.toLowerCase()?"ol":"ul",j=this.document.createDocumentFragment();h.adjustmentBoundary().shrinkBoundary();var i=h.createBookmark(!0),m=domUtils.findParentByTagName(this.document.getElementById(i.start),"li"),l=0,k=domUtils.findParentByTagName(this.document.getElementById(i.end),
"li"),n=0,t,q,o,s;if(m||k){m&&(t=m.parentNode);i.end||(k=m);k&&(q=k.parentNode);if(t===q){for(;m!==k;){s=m;m=m.nextSibling;if(!domUtils.isBlockElm(s.firstChild)){for(e=this.document.createElement("p");s.firstChild;)e.appendChild(s.firstChild);s.appendChild(e)}j.appendChild(s)}s=this.document.createElement("span");t.insertBefore(s,k);if(!domUtils.isBlockElm(k.firstChild)){for(e=this.document.createElement("p");k.firstChild;)e.appendChild(k.firstChild);k.appendChild(e)}j.appendChild(k);domUtils.breakParent(s,
t);domUtils.isEmptyNode(s.previousSibling)&&domUtils.remove(s.previousSibling);domUtils.isEmptyNode(s.nextSibling)&&domUtils.remove(s.nextSibling);e=domUtils.getComputedStyle(t,"list-style-type")||("insertorderedlist"==c.toLowerCase()?"decimal":"disc");if(t.tagName.toLowerCase()==f&&e==a){e=0;for(m=this.document.createDocumentFragment();t=j.childNodes[e++];)for(;t.firstChild;)m.appendChild(t.firstChild);s.parentNode.insertBefore(m,s)}else o=this.document.createElement(f),domUtils.setStyle(o,"list-style-type",
a),o.appendChild(j),s.parentNode.insertBefore(o,s);domUtils.remove(s);o&&b(o,f,a);h.moveToBookmark(i).select();return}if(m){for(;m;){s=m.nextSibling;o=this.document.createDocumentFragment();for(var r=0;m.firstChild;)domUtils.isBlockElm(m.firstChild)&&(r=1),o.appendChild(m.firstChild);r?j.appendChild(o):(r=this.document.createElement("p"),r.appendChild(o),j.appendChild(r));domUtils.remove(m);m=s}t.parentNode.insertBefore(j,t.nextSibling);domUtils.isEmptyNode(t)?(h.setStartBefore(t),domUtils.remove(t)):
h.setStartAfter(t);l=1}if(k){for(m=q.firstChild;m!==k;){s=m.nextSibling;o=this.document.createDocumentFragment();for(r=0;m.firstChild;)domUtils.isBlockElm(m.firstChild)&&(r=1),o.appendChild(m.firstChild);r?j.appendChild(o):(r=this.document.createElement("p"),r.appendChild(o),j.appendChild(r));domUtils.remove(m);m=s}j.appendChild(k.firstChild);domUtils.remove(k);q.parentNode.insertBefore(j,q);h.setEndBefore(q);domUtils.isEmptyNode(q)&&domUtils.remove(q);n=1}}l||h.setStartBefore(this.document.getElementById(i.start));
i.end&&!n&&h.setEndAfter(this.document.getElementById(i.end));h.enlarge(!0,function(a){return d[a.tagName]});j=this.document.createDocumentFragment();t=h.createBookmark();o=domUtils.getNextDomNode(t.start,!1,e);m=h.cloneRange();for(k=domUtils.isBlockElm;o&&o!==t.end&&domUtils.getPosition(o,t.end)&domUtils.POSITION_PRECEDING;)if(3==o.nodeType||dtd.li[o.tagName])if(1==o.nodeType&&dtd.$list[o.tagName]){for(;o.firstChild;)j.appendChild(o.firstChild);l=domUtils.getNextDomNode(o,!1,e);domUtils.remove(o);
o=l}else{l=o;for(m.setStartBefore(o);o&&o!==t.end&&(!k(o)||domUtils.isBookmarkNode(o));)l=o,o=domUtils.getNextDomNode(o,!1,null,function(a){return!d[a.tagName]});if(o&&k(o)&&(s=domUtils.getNextDomNode(l,!1,e))&&domUtils.isBookmarkNode(s))o=domUtils.getNextDomNode(s,!1,e),l=s;m.setEndAfter(l);o=domUtils.getNextDomNode(l,!1,e);s=h.document.createElement("li");s.appendChild(m.extractContents());j.appendChild(s)}else o=domUtils.getNextDomNode(o,!0,e);h.moveToBookmark(t).collapse(!0);o=this.document.createElement(f);
domUtils.setStyle(o,"list-style-type",a);o.appendChild(j);h.insertNode(o);b(o,f,a);h.moveToBookmark(i).select()},queryCommandState:function(b){return this.highlight?-1:utils.findNode(this.selection.getStartElementPath(),["insertorderedlist"==b.toLowerCase()?"ol":"ul"])?1:0},queryCommandValue:function(b){return(b=utils.findNode(this.selection.getStartElementPath(),["insertorderedlist"==b.toLowerCase()?"ol":"ul"]))?domUtils.getComputedStyle(b,"list-style-type"):null}}};(function(){function b(a){a=a||{};this.indentChar="";this.breakChar=a.breakChar||"\n";this.selfClosingEnd=a.selfClosingEnd||" />"}var c=function(){function a(a){return b[a]}var b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(b){return(b+="")?b.replace(/[<>"']/g,a):""}}(),d=utils.extend({a:1,A:1},dtd.$inline,!0);b.prototype={format:function(a){a=UE.serialize.parseHTML(a);this.buff=[];this.indents="";this.indenting=1;this.visitNode(a);return this.buff.join("")},visitNode:function(a){if("fragment"==
a.type)this.visitChildren(a.children);else if("element"==a.type){var b=dtd.$empty[a.tag];this.visitTag(a.tag,a.attributes,b);this.visitChildren(a.children);b||this.visitEndTag(a.tag)}else"comment"==a.type?this.visitComment(a.data):this.visitText(a.data,dtd.$notTransContent[a.parent.tag])},visitChildren:function(a){for(var b=0;b<a.length;b++)this.visitNode(a[b])},visitTag:function(a,b,e){this.indenting?this.indent():d[a]||(this.newline(),this.indent());this.buff.push("<",a);var f=[],j;for(j in b)f.push(j+
'="'+c(b[j])+'"');(b=f.join(" "))&&this.buff.push(" ",b);e?(this.buff.push(this.selfClosingEnd),"br"==a&&this.newline()):(this.buff.push(">"),this.indents+=this.indentChar);d[a]||this.newline()},indent:function(){this.buff.push(this.indents);this.indenting=0},newline:function(){this.buff.push(this.breakChar);this.indenting=1},visitEndTag:function(a){this.indents=this.indents.slice(0,-this.indentChar.length);this.indenting?this.indent():d[a]||(this.newline(),this.indent());this.buff.push("</",a,">")},
visitText:function(a){this.indenting&&this.indent();a=a.replace(/&nbsp;/g," ");this.buff.push(a)},visitComment:function(a){this.indenting&&this.indent();this.buff.push("<\!--",a,"--\>")}};var g={textarea:function(a,b){var e=b.ownerDocument.createElement("textarea");e.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";browser.ie&&8>browser.version&&(e.style.width=b.offsetWidth+"px",e.style.height=b.offsetHeight+"px",b.onresize=function(){e.style.width=
b.offsetWidth+"px";e.style.height=b.offsetHeight+"px"});b.appendChild(e);return{setContent:function(a){e.value=a},getContent:function(){return e.value},select:function(){var a;if(browser.ie){a=e.createTextRange();a.collapse(true);a.select()}else{e.setSelectionRange(0,0);e.focus()}},dispose:function(){b.removeChild(e);b=e=b.onresize=null}}},codemirror:function(a,b){var e=window.CodeMirror(b,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),f=e.getWrapperElement();f.style.cssText=
'position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';e.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";e.refresh();return{setContent:function(a){e.setValue(a)},getContent:function(){return e.getValue()},select:function(){e.focus()},dispose:function(){b.removeChild(f);e=f=null}}}};UE.plugins.source=function(){function a(a){var a=a.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>",a=a.replace(/>[\n\r\t]+/g,
">").replace(/[\n\r\t]+</g,"<").replace(/>[\n\r\t]+</g,"><"),b=/(<img|<img([^\/>]+?))\s+(small)?src\s*=\s*("\s*(?!http).*"|\s*(?!http)[^\s>"]+)(.*?\/?>)/gi;try{a=a.replace(b,"")}catch(f){}return a=a.replace(/<p>([ ])+<\/p>/gi,function(a){return a.replace(/[ ]/gi,"&nbsp;")})}var c=this,e=this.options,f=new b(e.source),d=!1,i,m;c.commands.source={execCommand:function(){if(d=!d){c.undoManger&&c.undoManger.save();this.currentSelectedArr&&domUtils.clearSelectedArr(this.currentSelectedArr);browser.gecko&&
(c.body.contentEditable=!1);m=c.iframe.style.cssText;c.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var b=f.format(c.hasContents()?c.getContent():"");i=g["codemirror"==e.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](c,c.iframe.parentNode);i.setContent(b);setTimeout(function(){i.select()})}else{c.iframe.style.cssText=m;b=a(i);if(/<embed/.test(b)){c.setContent(b);for(var l=!1,k=c.document.getElementsByTagName("embed")||[],o=0;o<k.length;o++)"transparent"!=k[o].getAttribute("wmode")&&
(l=!0,k[o].setAttribute("wmode","transparent"));l&&(b=f.format(c.hasContents()?c.getContent():""),i.setContent(b),b=a(i))}c.setContent(b);i.dispose();i=null;setTimeout(function(){var a=c.body.firstChild;a||(c.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",a=c.body.firstChild);for(c.undoManger&&c.undoManger.save();a&&a.firstChild;)a=a.firstChild;var b=c.selection.getRange();3==a.nodeType||dtd.$empty[a.tagName]?b.setStartBefore(a):b.setStart(a,0);if(browser.gecko){var f=document.createElement("input");
f.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(f);c.body.contentEditable=!1;setTimeout(function(){domUtils.setViewportOffset(f,{left:-32768,top:0});f.focus();setTimeout(function(){c.body.contentEditable=true;b.setCursor(false,true);domUtils.remove(f)})})}else b.setCursor(!1,!0)})}this.fireEvent("sourcemodechanged",d)},queryCommandState:function(){return d|0}};var l=c.queryCommandState;c.queryCommandState=function(a){a=a.toLowerCase();return d?"source"==a?1:-1:l.apply(this,
arguments)};var k=c.getContent;c.getContent=function(){if(d&&i){var a=i.getContent(),a=this.document.body.innerHTML.replace(RegExp(domUtils.fillChar,"g"),"").replace(/>[\t\r\n]*?</g,"><");this.serialize&&(a=this.serialize.parseHTML(a),a=this.serialize.filter(a),a=this.serialize.toHTML(a));return a}return k.apply(this,arguments)};c.addListener("ready",function(){"codemirror"==e.sourceEditor&&(utils.loadFile(document,{src:e.codeMirrorJsUrl,tag:"script",type:"text/javascript",defer:"defer"}),utils.loadFile(document,
{tag:"link",rel:"stylesheet",type:"text/css",href:e.codeMirrorCssUrl}))})}})();UE.plugins.enterkey=function(){var b,c=this,d=c.options.enterTag;c.addListener("keyup",function(d,a){if(13==(a.keyCode||a.which)){var h=c.selection.getRange(),e=h.startContainer,f;if(!browser.ie&&/h\d/i.test(b)){if(browser.gecko)domUtils.findParentByTagName(e,"h1 h2 h3 h4 h5 h6 blockquote".split(" "),!0)||(c.document.execCommand("formatBlock",!1,"<p>"),f=1);else if(1==e.nodeType){var e=c.document.createTextNode(""),j;h.insertNode(e);if(j=domUtils.findParentByTagName(e,"div",!0)){for(f=c.document.createElement("p");j.firstChild;)f.appendChild(j.firstChild);
j.parentNode.insertBefore(f,j);domUtils.remove(j);h.setStartBefore(e).setCursor();f=1}domUtils.remove(e)}c.undoManger&&f&&c.undoManger.save()}setTimeout(function(){c.selection.getRange().scrollToView(c.autoHeightEnabled,c.autoHeightEnabled?domUtils.getXY(c.iframe).y:0)},50)}});c.addListener("keydown",function(g,a){if(13==(a.keyCode||a.which)){c.undoManger&&c.undoManger.save();b="";var h=c.selection.getRange();if(!h.collapsed){var e=h.startContainer,f=h.endContainer,e=domUtils.findParentByTagName(e,
"td",!0),f=domUtils.findParentByTagName(f,"td",!0);if(e&&f&&e!==f||!e&&f||e&&!f){a.preventDefault?a.preventDefault():a.returnValue=!1;return}}c.currentSelectedArr&&domUtils.clearSelectedArr(c.currentSelectedArr);if("p"==d)browser.ie||((e=domUtils.findParentByTagName(h.startContainer,"ol ul p h1 h2 h3 h4 h5 h6 blockquote".split(" "),!0))?(b=e.tagName,"p"==e.tagName.toLowerCase()&&browser.gecko&&domUtils.removeDirtyAttr(e)):(c.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(h=c.selection.getRange(),
(e=domUtils.findParentByTagName(h.startContainer,"p",!0))&&domUtils.removeDirtyAttr(e))));else if(a.preventDefault?a.preventDefault():a.returnValue=!1,h.collapsed)f=h.document.createElement("br"),h.insertNode(f),f.parentNode.lastChild===f?(f.parentNode.insertBefore(f.cloneNode(!0),f),h.setStartBefore(f)):h.setStartAfter(f),h.setCursor();else if(h.deleteContents(),e=h.startContainer,1==e.nodeType&&(e=e.childNodes[h.startOffset])){for(;1==e.nodeType;){if(dtd.$empty[e.tagName])return h.setStartBefore(e).setCursor(),
c.undoManger&&c.undoManger.save(),!1;if(!e.firstChild)return f=h.document.createElement("br"),e.appendChild(f),h.setStart(e,0).setCursor(),c.undoManger&&c.undoManger.save(),!1;e=e.firstChild}e===h.startContainer.childNodes[h.startOffset]?(f=h.document.createElement("br"),h.insertNode(f).setCursor()):h.setStart(e,0).setCursor()}else f=h.document.createElement("br"),h.insertNode(f).setStartAfter(f).setCursor()}})};UE.plugins.keystrokes=function(){var b=this,c=0,d=domUtils.keys,g={B:"strong",I:"em",FONT:"span"},a=[0,10,12,16,18,24,32,48],h={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};b.addListener("keydown",function(a,f){var d,i,g=f.keyCode||f.which;if(this.selectAll&&(this.selectAll=!1,8==g||46==g)){b.undoManger&&b.undoManger.save();b.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";(new dom.Range(b.document)).setStart(b.body.firstChild,0).setCursor(!1,
!0);b.undoManger&&b.undoManger.save();browser.ie&&b._selectionChange();domUtils.preventDefault(f);return}if(8==g){var l=b.selection.getRange(),k,n;if(l.collapsed&&(n=l.startContainer,domUtils.isWhitespace(n)&&(n=n.parentNode),domUtils.isEmptyNode(n)&&n===b.body.firstChild)){"P"!=n.tagName&&(p=b.document.createElement("p"),b.body.insertBefore(p,n),domUtils.fillNode(b.document,p),l.setStart(p,0).setCursor(!1,!0),domUtils.remove(n));domUtils.preventDefault(f);return}l.collapsed&&(3==l.startContainer.nodeType&&
0==l.startContainer.nodeValue.replace(RegExp(domUtils.fillChar,"g"),"").length)&&l.setStartBefore(l.startContainer).collapse(!0);if(n=l.getClosedNode()){b.undoManger&&b.undoManger.save();l.setStartBefore(n);domUtils.remove(n);l.setCursor();b.undoManger&&b.undoManger.save();domUtils.preventDefault(f);return}if(!browser.ie){n=domUtils.findParentByTagName(l.startContainer,"table",!0);k=domUtils.findParentByTagName(l.endContainer,"table",!0);if(n&&!k||!n&&k||n!==k){f.preventDefault();return}if(browser.webkit&&
(l.collapsed&&n)&&(k=l.cloneRange().txtToElmBoundary(),n=k.startContainer,domUtils.isBlockElm(n)&&1==n.nodeType&&!dtd.$tableContent[n.tagName]&&!domUtils.getChildCount(n,function(a){return 1==a.nodeType?"BR"!==a.tagName:1}))){k.setStartBefore(n).setCursor();domUtils.remove(n,!0);f.preventDefault();return}}b.undoManger&&!l.collapsed&&(b.undoManger.save(),c=1)}if(9==g){l=b.selection.getRange();b.undoManger&&b.undoManger.save();k=0;for(n="";k<b.options.tabSize;k++)n+=b.options.tabNode;i=b.document.createElement("span");
i.innerHTML=n;if(l.collapsed)l.insertNode(i.cloneNode(!0).firstChild).setCursor(!0);else{n=domUtils.findParentByTagName(l.startContainer,"table",!0);k=domUtils.findParentByTagName(l.endContainer,"table",!0);if(n||k){f.preventDefault?f.preventDefault():f.returnValue=!1;return}n=domUtils.findParentByTagName(l.startContainer,["ol","ul"],!0);k=domUtils.findParentByTagName(l.endContainer,["ol","ul"],!0);if(n&&k&&n===k){var t=l.createBookmark();n=domUtils.findParentByTagName(l.startContainer,"li",!0);k=
domUtils.findParentByTagName(l.endContainer,"li",!0);if(n===n.parentNode.firstChild)k=b.document.createElement(n.parentNode.tagName),n.parentNode.parentNode.insertBefore(k,n.parentNode),k.appendChild(n.parentNode);else{d=n.parentNode;i=b.document.createElement(d.tagName);d=utils.indexOf(h[i.tagName],domUtils.getComputedStyle(d,"list-style-type"));d=d+1==h[i.tagName].length?0:d+1;domUtils.setStyle(i,"list-style-type",h[i.tagName][d]);for(n.parentNode.insertBefore(i,n);n!==k;)d=n.nextSibling,i.appendChild(n),
n=d;i.appendChild(k)}l.moveToBookmark(t).select()}else{if(n||k){f.preventDefault?f.preventDefault():f.returnValue=!1;return}n=domUtils.findParent(l.startContainer,t);k=domUtils.findParent(l.endContainer,t);if(n&&k&&n===k)l.deleteContents(),l.insertNode(i.cloneNode(!0).firstChild).setCursor(!0);else{n=l.createBookmark();t=function(a){return domUtils.isBlockElm(a)};l.enlarge(!0);k=l.createBookmark();for(d=domUtils.getNextDomNode(k.start,!1,t);d&&!(domUtils.getPosition(d,k.end)&domUtils.POSITION_FOLLOWING);)d.insertBefore(i.cloneNode(!0).firstChild,
d.firstChild),d=domUtils.getNextDomNode(d,!1,t);l.moveToBookmark(k).moveToBookmark(n).select()}}}b.undoManger&&b.undoManger.save();f.preventDefault?f.preventDefault():f.returnValue=!1}if(browser.gecko&&46==g&&(l=b.selection.getRange(),l.collapsed&&(n=l.startContainer,domUtils.isEmptyBlock(n)))){for(g=n.parentNode;1==domUtils.getChildCount(g)&&!domUtils.isBody(g);)n=g,g=g.parentNode;n===g.lastChild&&f.preventDefault()}});b.addListener("keyup",function(e,f){var h=f.keyCode||f.which;if(!browser.gecko&&
(!d[h]&&!f.ctrlKey&&!f.metaKey&&!f.shiftKey&&!f.altKey)&&(k=b.selection.getRange(),k.collapsed)){for(var i=k.startContainer,m=0;!domUtils.isBlockElm(i);){if(1==i.nodeType&&-1!=utils.indexOf(["FONT","B","I"],i.tagName)){var l=b.document.createElement(g[i.tagName]);"FONT"==i.tagName&&(l.style.cssText=(i.getAttribute("size")?"font-size:"+(a[i.getAttribute("size")]||12)+"px":"")+";"+(i.getAttribute("color")?"color:"+i.getAttribute("color"):"")+";"+(i.getAttribute("face")?"font-family:"+i.getAttribute("face"):
"")+";"+i.style.cssText);for(;i.firstChild;)l.appendChild(i.firstChild);i.parentNode.insertBefore(l,i);domUtils.remove(i);m||k.setEnd(l,l.childNodes.length).collapse(!0);i=l;m=1}i=i.parentNode}m&&k.select()}if(8==h){if(browser.gecko){k=0;for(h=domUtils.getElementsByTagName(this.body,"li");i=h[k++];)domUtils.isEmptyNode(i)&&!i.previousSibling&&(m=i.parentNode,domUtils.remove(i),domUtils.isEmptyNode(m)&&domUtils.remove(m))}var k;if((i=this.currentSelectedArr)&&0<i.length){for(k=0;h=i[k++];)h.innerHTML=
browser.ie?9>browser.version?"&#65279":"":"<br/>";k=new dom.Range(this.document);k.setStart(i[0],0).setCursor();c&&(b.undoManger.save(),c=0);browser.webkit&&f.preventDefault()}else{k=b.selection.getRange();i=k.startContainer;domUtils.isWhitespace(i)&&(i=i.parentNode);for(m=0;1==i.nodeType&&domUtils.isEmptyNode(i)&&dtd.$removeEmpty[i.tagName];)m=1,h=i.parentNode,domUtils.remove(i),i=h;if(m&&1==i.nodeType&&domUtils.isEmptyNode(i)){if(browser.ie){var n=k.document.createElement("span");i.appendChild(n);
k.setStart(i,0).setCursor();if(i=domUtils.findParentByTagName(i,"li",!0))for(k=i.nextSibling;k;)if(domUtils.isEmptyBlock(k))i=k,k=k.nextSibling,domUtils.remove(i);else break}else i.innerHTML="<br/>",k.setStart(i,0).setCursor(!1,!0);setTimeout(function(){browser.ie&&domUtils.remove(n);if(c){b.undoManger.save();c=0}},0)}else c&&(b.undoManger.save(),c=0)}}})};UE.plugins.autoheight=function(){function b(){e&&(e=clearTimeout(e));c.bakAutoHeightEnabled&&(!c.ui||!c.ui.isFullScreen())&&(e=setTimeout(function(){1!=c.queryCommandState("source")&&(g||(g=c.document.createElement("span"),g.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",g.innerHTML="."),a=g.cloneNode(!0),c.body.appendChild(a),h=Math.max(domUtils.getXY(a).y+a.offsetHeight,c.options.minFrameHeight),f>h&&(h=f),j<=h?(h=j,c.body.style.overflowY=d||""):c.body.style.overflowY=
"hidden",c.setHeight(h),domUtils.remove(a))},50))}var c=this,d,g,a,h,e,f=0,j=0;c.addListener("destroy",function(){c.removeListener("contentchange",b);c.removeListener("keyup",b);c.removeListener("mouseup",b)});c.enableAutoHeight=function(a,h,g){if(!c.ui||!c.ui.isFullScreen())e&&(e=clearTimeout(e)),g?(f=a||f||0,j=h||j||0):(f=a||0,j=h||0),-1==j&&(c.autoHeightEnabled=!0),c.bakAutoHeightEnabled||(a=c.document,c.bakAutoHeightEnabled=!0,d=a.body.style.overflowY,a.body.style.overflowY="hidden",c.addListener("contentchange",
b),c.addListener("keyup",b),c.addListener("mouseup",b)),setTimeout(function(){b()},browser.gecko?100:0),c.fireEvent("autoheightchanged",c.bakAutoHeightEnabled)};c.disableAutoHeight=function(){e&&(e=clearTimeout(e));c.body.style.overflowY=d||"";c.removeListener("contentchange",b);c.removeListener("keyup",b);c.removeListener("mouseup",b);c.autoHeightEnabled=!1;c.bakAutoHeightEnabled=!1;c.fireEvent("autoheightchanged",c.bakAutoHeightEnabled)};c.addListener("ready",function(){c.options.autoHeightEnabled&&
c.enableAutoHeight();var a;domUtils.on(browser.ie?c.body:c.document,browser.webkit?"dragover":"drop",function(){a&&(a=clearTimeout(a));a=setTimeout(function(){b()},100)})})};UE.plugins.serialize=function(){function b(a){return/pt/.test(a)?a.replace(/([\d.]+)pt/g,function(a){return Math.round(96*parseFloat(a)/72)+"px"}):a}function c(a){var b;a&&"p"==a.tag&&("MsoListParagraph"==a.attributes["class"]||/mso-list/.test(a.attributes.style)?b=1:(a=a.children[0])&&("span"==a.tag&&/Wingdings/i.test(a.attributes.style))&&(b=1));return b}function d(a,b){if("element"==a.type&&!a.children.length&&dtd.$removeEmpty[a.tag]&&"a"!=a.tag)return{type:"fragment",children:[]};var f=[0,10,
12,16,18,24,32,48],e;e=utils.indexOf;switch(a.tag){case "img":if(a.attributes.src&&/^data:/.test(a.attributes.src))return{type:"fragment",children:[]};if(a.attributes.src&&/^(?:file)/.test(a.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(a.attributes.src))return{type:"fragment",children:[]};a.attributes.word_img=a.attributes.src;a.attributes.src=j.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";f=128>parseInt(a.attributes.width)||43>parseInt(a.attributes.height);a.attributes.style=
"background:url("+j.options.UEDITOR_HOME_URL+"themes/default/images/"+(f?"word.gif":"localimage.png")+") no-repeat center center;border:1px solid #ddd";b&&(b.flag=1)}browser.ie&&(7>browser.version&&j.options.relativePath)&&(a.attributes.orgSrc=a.attributes.src);a.attributes.data_ue_src=a.attributes.data_ue_src||a.attributes.src;break;case "li":f=a.children[0];if(!f||"element"!=f.type||"p"!=f.tag&&dtd.p[f.tag])e={type:"element",tag:"p",attributes:{},parent:a},e.children=f?a.children:[browser.ie?{type:"text",
data:domUtils.fillChar,parent:e}:{type:"element",tag:"br",attributes:{},closed:!0,children:[],parent:e}],a.children=[e];break;case "table":case "td":g(a);break;case "a":a.attributes.anchorname&&(a.tag="img",a.attributes={"class":"anchorclass",anchorname:a.attributes.name},a.closed=1);a.attributes.href&&(a.attributes.data_ue_src=a.attributes.href);break;case "b":a.tag=a.name="strong";break;case "i":a.tag=a.name="em";break;case "u":a.tag=a.name="span";a.attributes.style=(a.attributes.style||"")+";text-decoration:underline;";
break;case "s":case "del":a.tag=a.name="span";a.attributes.style=(a.attributes.style||"")+";text-decoration:line-through;";1==a.children.length&&(f=a.children[0],f.tag==a.tag&&(a.attributes.style+=";"+f.attributes.style,a.children=f.children));break;case "span":if(/mso-list/.test(a.attributes.style)){if("end"!=v){for(var f=a.children[0],d;"element"==f.type;)f=f.children[0];for(d in s)if(s[d].test(f.data)){r="ul";u=d;break}if(!r)for(d in o)if(o[d].test(f.data.replace(/\.$/,""))){r="ol";u=d;break}v?
(f.data==v?("ul"!=r&&(u=""),r="ul"):("ol"!=r&&(u=""),r="ol"),v="end"):v=f.data;if(r){for(f=a;f&&"ul"!=f.tag&&"ol"!=f.tag;)f=f.parent;f&&(f.tag=r,f.attributes.style="list-style-type:"+u)}}a={type:"fragment",children:[]};break}if(f=a.attributes.style)if(f=f.match(/(?:\b(?:color|font-size|background(-color)?|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi))a.attributes.style=f.join(";"),a.attributes.style||delete a.attributes.style;browser.gecko&&(10902>=browser.version&&a.parent)&&(f=
a.parent,"span"==f.tag&&(f.attributes&&f.attributes.style)&&(a.attributes.style=f.attributes.style+";"+a.attributes.style));utils.isEmptyObject(a.attributes)&&(a.type="fragment");break;case "font":a.tag=a.name="span";e=a.attributes;for(a.attributes={style:(e.size?"font-size:"+(f[e.size]||12)+"px":"")+";"+(e.color?"color:"+e.color:"")+";"+(e.face?"font-family:"+e.face:"")+";"+(e.style||"")};a.parent.tag==a.tag&&1==a.parent.children.length;)a.attributes.style&&(a.parent.attributes.style?a.parent.attributes.style+=
";"+a.attributes.style:a.parent.attributes.style=a.attributes.style),a.parent.children=a.children,a=a.parent;break;case "p":if(a.attributes.align&&(a.attributes.style=(a.attributes.style||"")+";text-align:"+a.attributes.align+";",delete a.attributes.align),c(a)){if(!q){f={type:"element",tag:"ul",attributes:{},children:[]};e=e(a.parent.children,a);a.parent.children[e]=f;f.parent=a.parent;f.children[0]=a;for(a.parent=f;;)if(a=f.parent.children[e+1],c(a))f.children[f.children.length]=a,a.parent=f,f.parent.children.splice(e+
1,1);else break;return f}a.tag=a.name="li";if(browser.webkit){for(f=a.children[0];f&&"element"==f.type;)f=f.children[0];f&&(f.parent.attributes.style=(f.parent.attributes.style||"")+";mso-list:10")}delete a.attributes["class"];delete a.attributes.style}}return a}function g(a){e&&a.attributes.style&&(a.attributes.style=a.attributes.style.replace(/;\s*/g,";"),a.attributes.style=a.attributes.style.replace(/^\s*|\s*$/,""))}function a(a,b,f){if(!a.children||!a.children.length)return a;for(var e=a.children,
c=0;c<e.length;c++){var d=b(e[c],f);if("fragment"==d.type){var i=[c,1];i.push.apply(i,d.children);e.splice.apply(e,i);e.length||(a={type:"fragment",children:[]});c--}else e[c]=d}return a}function h(a){this.rules=a}var e=browser.ie,f=browser.version,j=this,i=dtd.$empty,m=function(){function a(i,j){var g,m=0,l,k;for(b.exec("");g=b.exec(i);){l=g.index;if(l>m)if(m=i.slice(m,l),k)k.push(m);else j.onText(m);m=b.lastIndex;if(l=g[1])if(l=l.toLowerCase(),k&&l==k._tag_name&&(j.onCDATA(k.join("")),k=null),!k){j.onTagClose(l);
continue}if(k)k.push(g[0]);else if(l=g[3]){if(!/="/.test(l)){l=l.toLowerCase();g=g[4];var n,s={},r=g&&"/"==g.slice(-1);if(g)for(c.exec("");n=c.exec(g);){var t=n[1].toLowerCase();n=n[2]||n[3]||n[4]||"";!n&&d[t]&&(n=t);"style"==t&&e&&6>=f&&(n=n.replace(/(?!;)\s*([\w-]+):/g,function(a,b){return b.toLowerCase()+":"}));n&&(s[t]=n.replace(/:\s*/g,":"))}j.onTagOpen(l,s,r);!k&&h[l]&&(k=[],k._tag_name=l)}}else if(l=g[2])j.onComment(l)}if(i.length>m)j.onText(i.slice(m,i.length))}var b=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\>)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,
c=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,d={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},h={script:1,style:1},j={li:{$:"ul",ul:1,ol:1},dd:{$:"dl",dl:1},dt:{$:"dl",dl:1},option:{$:"select",select:1},td:{$:"tr",tr:1},th:{$:"tr",tr:1},tr:{$:"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{$:"table",table:1,colgroup:1},thead:{$:"table",table:1},tfoot:{$:"table",table:1},col:{$:"colgroup",
colgroup:1}},g={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};return function(b,f){function e(a){a.parent=m;m.children.push(a)}function c(a,b){var e=a;if(j[e.tag]){for(;j[m.tag]&&j[m.tag][e.tag];)m=m.parent;m.tag==e.tag&&(m=m.parent);for(;j[e.tag]&&!j[e.tag][m.tag];)e=e.parent={type:"element",tag:j[e.tag].$,attributes:{},children:[e]}}if(f)for(;dtd[e.tag]&&!("span"==m.tag?utils.extend(dtd.strong,{a:1,A:1}):dtd[m.tag]||dtd.div)[e.tag];)if(!d(m)){if(!m.parent)break;
m=m.parent}e.parent=m;m.children.push(e);b&&(m=a);a.attributes.style&&(a.attributes.style=a.attributes.style.toLowerCase());return a}function d(a){var b;return!a.children.length&&(b=g[a.tag])?(c({type:"element",tag:b,attributes:{},children:[]},!0),!0):!1}var h={type:"fragment",parent:null,children:[]},m=h;for(a(b,{onText:function(a){for(;!(dtd[m.tag]||dtd.div)["#"];)d(m)||(m=m.parent);e({type:"text",data:a})},onComment:function(a){e({type:"comment",data:a})},onCDATA:function(a){for(;!(dtd[m.tag]||
dtd.div)["#"];)d(m)||(m=m.parent);e({type:"cdata",data:a})},onTagOpen:function(a,b,f){f=f||i[a];c({type:"element",tag:a,attributes:b,closed:f,children:[]},!f)},onTagClose:function(a){for(var b=m;b&&a!=b.tag;)b=b.parent;if(b){for(a=m;a!==b.parent;a=a.parent)d(a);m=b.parent}else if(!dtd.$removeEmpty[a]&&!(dtd.$removeEmptyBlock[a]||"embed"==a))b={type:"element",tag:a,attributes:{},children:[]},c(b,!0),d(b),m=b.parent}});m!==h;)d(m),m=m.parent;return h}}(),l=function(){function a(f){return b[f]}var b=
{"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(b){return(b+="")?b.replace(/[<>"']/g,a):""}}(),k=function(){function a(b,f){for(var e=b.children,c=[],d=0,i;i=e[d];d++)c.push(k(i,f));return c.join("")}function f(a){var e=[],c;for(c in a){var d=a[c];"style"==c&&(d=b(d),/rgba?\s*\([^)]*\)/.test(d)&&(d=d.replace(/rgba?\s*\(([^)]*)\)/g,function(a){return utils.fixColor("color",a)})),a[c]=utils.optCss(d.replace(/windowtext/g,"#000")));e.push(c+'="'+l(a[c])+'"')}return e.join(" ")}var e=
{div:"p",li:"p",tr:"p",br:"br",p:"p"};return function(b,c){if("fragment"==b.type)return a(b,c);if("element"==b.type){var d=b.tag;if(c&&"td"==d)h||(h=""),h+=a(b,c)+"&nbsp;&nbsp;&nbsp;";else{var h=f(b.attributes),h="<"+(c&&e[d]?e[d]:d)+(h?" "+h:"")+(i[d]?" />":">");i[d]||(browser.ie&&("p"==d&&!b.children.length)&&(h+="&nbsp;"),h+=a(b,c),h+="</"+(c&&e[d]?e[d]:d)+">")}return h}return"text"==b.type||"cdata"==b.type?dtd.$notTransContent[b.parent.tag]?b.data.replace(/&nbsp;/g," "):l(b.data).replace(/ /g,
"&nbsp;"):"comment"==b.type?"<\!--"+b.data+"--\>":""}}(),n=function(){function a(b){return b=b.replace(/([\d.]+)([\w]+)?/g,function(a,b,f){return(Math.round(parseFloat(b))||1)+(f||"px")})}function f(e){e=e.replace(/<\!--\s*EndFragment\s*--\>[\s\S]*$/,"").replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,"").replace(/^\s*(&nbsp;)+/ig,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"").replace(/<\!--[\s\S]*?--\>/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(a){var f=a.match(/width:([ \d.]*p[tx])/i)[1],
e=a.match(/height:([ \d.]*p[tx])/i)[1],a=a.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+b(f)+'" height="'+b(e)+'" src="'+a+'" />'}).replace(/v:\w+=["']?[^'"]+["']?/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"").replace(/<font[^>]*>\s*<\/font>/gi,"").replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoNormal(Table)?))\s*["']?/gi,
"");e=e.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(b,f,e,d){b=[];e=0;d=d.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(e=0;e<d.length;e++){var c,i,h=d[e].split(":");if(2==h.length){c=h[0].toLowerCase();i=h[1].toLowerCase();switch(c){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-table-layout-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":/<table/.test(f)||
(b[e]=c.replace(/^mso-|-alt$/g,"")+":"+a(i));continue;case "horiz-align":b[e]="text-align:"+i;continue;case "vert-align":b[e]="vertical-align:"+i;continue;case "font-color":case "mso-foreground":b[e]="color:"+i;continue;case "mso-background":case "mso-highlight":b[e]="background:"+i;continue;case "mso-default-height":b[e]="min-height:"+a(i);continue;case "mso-default-width":b[e]="min-width:"+a(i);continue;case "mso-padding-between-alt":b[e]="border-collapse:separate;border-spacing:"+a(i);continue;
case "text-line-through":if("single"==i||"double"==i)b[e]="text-decoration:line-through";continue;case "mso-zero-height":"yes"==i&&(b[e]="display:none");continue;case "margin":if(!/[1-9]/.test(h[1]))continue}if(!/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(c)||/mso\-list/.test(c))b[e]=c+":"+h[1]}}return 0<e?f+' style="'+b.join(";")+'"':f});return e=e.replace(/([ ]+)<\/span>/ig,
function(a,b){return Array(b.length+1).join("&nbsp;")+"</span>"})}return function(a){q=null;v=u=r="";RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig).test(a)&&(a=f(a));return a.replace(/>[ \t\r\n]*</g,"><")}}(),t={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"},q,o={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,
"upper-alpha":/^\(?[A-Z]+\)?$/},s={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},r="",u="",v;h.prototype={rules:null,filter:function(b,f,e){function c(b,f){b.name="element"==b.type?b.tag:t[b.type];if(null==f)return a(b,c,b);if(i&&i[b.name])return e&&(e.flag=1),{type:"fragment",children:[]};if(d&&"element"==b.type)if("fragment"==f.type?d[b.name]:d[b.name]&&d[f.name][b.name]){var h;if(h=d[b.name].$){var j=b.attributes,g={},m;for(m in h)j[m]&&(g[m]=j[m]);b.attributes=g}}else e&&
(e.flag=1),b.type="fragment",b.name=f.name;(i||d)&&a(b,c,b);return b}var d=(f=f||this.rules)&&f.whiteList,i=f&&f.blackList;return c(b,null)},transformInput:function(b,f){function e(b){b=d(b,f);if("ol"==b.tag||"ul"==b.tag)q=1;b=a(b,e,b);if("ol"==b.tag||"ul"==b.tag)q=0,v=u=r="";"text"==b.type&&b.data.replace(/\s/g,"")==j.options.pageBreakTag&&(b.type="element",b.name=b.tag="hr",delete b.data,b.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"},
b.children=[]);"text"==b.type&&!dtd.$notTransContent[b.parent.tag]&&(b.data=b.data.replace(/[\r\t\n]*/g,""));return b}return e(b)},transformOutput:function(b){function f(b){"hr"==b.tag&&"pagebreak"==b.attributes["class"]&&(delete b.tag,b.type="text",b.data=j.options.pageBreakTag,delete b.children);a:switch(b.tag){case "table":!b.attributes.style&&delete b.attributes.style;e&&b.attributes.style&&g(b);break;case "td":case "th":if(/display\s*:\s*none/i.test(b.attributes.style)){b={type:"fragment",children:[]};
break a}e&&!b.children.length&&(b.children[0]={type:"text",data:domUtils.fillChar,parent:b});e&&b.attributes.style&&g(b);break;case "img":b.attributes.anchorname?(b.tag="a",b.attributes={name:b.attributes.anchorname,anchorname:1},b.closed=null):b.attributes.data_ue_src&&(b.attributes.src=b.attributes.data_ue_src,delete b.attributes.data_ue_src);break;case "a":b.attributes.data_ue_src&&(b.attributes.href=b.attributes.data_ue_src,delete b.attributes.data_ue_src)}if("ol"==b.tag||"ul"==b.tag)q=1;b=a(b,
f,b);if("ol"==b.tag||"ul"==b.tag)q=0;return b}return f(b)},toHTML:k,parseHTML:m,word:n};j.serialize=new h(j.options.serialize);UE.serialize=new h({})};UE.plugins.basestyle=function(){var b={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},c=function(a,b){var e=a.selection.getStartElementPath();return utils.findNode(e,b)},d=this,g;for(g in b)(function(a,b){d.commands[a]={execCommand:function(a){var f=new dom.Range(d.document),j="";if(d.currentSelectedArr&&0<d.currentSelectedArr.length){for(var i=0,g;g=d.currentSelectedArr[i++];)if("none"!=g.style.display){f.selectNodeContents(g).select();!j&&(j=c(this,b));if("superscript"==
a||"subscript"==a)(!j||j.tagName.toLowerCase()!=a)&&f.removeInlineStyle(["sub","sup"]);j?f.removeInlineStyle(b):f.applyInlineStyle(b[0])}f.selectNodeContents(d.currentSelectedArr[0]).select()}else{f=d.selection.getRange();j=c(this,b);if(f.collapsed){if(j)a=d.document.createTextNode(""),f.insertNode(a).removeInlineStyle(b),f.setStartBefore(a),domUtils.remove(a);else{j=f.document.createElement(b[0]);if("superscript"==a||"subscript"==a)a=d.document.createTextNode(""),f.insertNode(a).removeInlineStyle(["sub",
"sup"]).setStartBefore(a).collapse(!0);f.insertNode(j).setStart(j,0)}f.collapse(!0)}else{if("superscript"==a||"subscript"==a)(!j||j.tagName.toLowerCase()!=a)&&f.removeInlineStyle(["sub","sup"]);j?f.removeInlineStyle(b):f.applyInlineStyle(b[0])}f.select()}return!0},queryCommandState:function(){return this.highlight?-1:c(this,b)?1:0}}})(g,b[g])};baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){function b(){var a=document.getElementById("edui_fixedlayer");h.setViewportOffset(a,{left:0,top:0})}var c=baidu.editor.browser,d=baidu.editor.dom.domUtils,g=window.$EDITORUI={},a=0,h=baidu.editor.ui.uiUtils={uid:function(b){return b?b.ID$EDITORUI||(b.ID$EDITORUI=++a):++a},hook:function(a,b){var d;a&&a._callbacks?d=a:(d=function(){var b;a&&(b=a.apply(this,arguments));for(var f=d._callbacks,c=f.length;c--;){var h=f[c].apply(this,arguments);void 0===b&&(b=h)}return b},d._callbacks=[]);d._callbacks.push(b);
return d},createElementByHtml:function(a){var b=document.createElement("div");b.innerHTML=a;b=b.firstChild;b.parentNode.removeChild(b);return b},getViewportElement:function(){return c.ie&&c.quirks?document.body:document.documentElement},getClientRect:function(a){for(var b=a.getBoundingClientRect(),c={left:Math.round(b.left),top:Math.round(b.top),height:Math.round(b.bottom-b.top),width:Math.round(b.right-b.left)},i;(i=a.ownerDocument)!==document&&(a=d.getWindow(i).frameElement);)b=a.getBoundingClientRect(),
c.left+=b.left,c.top+=b.top;c.bottom=c.top+c.height;c.right=c.left+c.width;return c},getViewportRect:function(){var a=h.getViewportElement(),b=(window.innerWidth||a.clientWidth)|0,a=(window.innerHeight||a.clientHeight)|0;return{left:0,top:0,height:a,width:b,bottom:a,right:b}},setViewportOffset:function(a,b){var c=h.getFixedLayer();a.parentNode===c?(a.style.left=b.left+"px",a.style.top=b.top+"px"):d.setViewportOffset(a,b)},getEventOffset:function(a){var b=h.getClientRect(a.target||a.srcElement),a=
h.getViewportOffsetByEvent(a);return{left:a.left-b.left,top:a.top-b.top}},getViewportOffsetByEvent:function(a){var b=a.target||a.srcElement,c=d.getWindow(b).frameElement,a={left:a.clientX,top:a.clientY};c&&b.ownerDocument!==document&&(b=h.getClientRect(c),a.left+=b.left,a.top+=b.top);return a},setGlobal:function(a,b){g[a]=b;return'$EDITORUI["'+a+'"]'},unsetGlobal:function(a){delete g[a]},copyAttributes:function(a,b){for(var d=b.attributes,i=d.length;i--;){var h=d[i];"style"!=h.nodeName&&("class"!=
h.nodeName&&(!c.ie||h.specified))&&a.setAttribute(h.nodeName,h.nodeValue)}b.className&&(a.className+=" "+b.className);b.style.cssText&&(a.style.cssText+=";"+b.style.cssText)},removeStyle:function(a,b){if(a.style.removeProperty)a.style.removeProperty(b);else if(a.style.removeAttribute)a.style.removeAttribute(b);else throw"";},contains:function(a,b){return a&&b&&(a===b?!1:a.contains?a.contains(b):a.compareDocumentPosition(b)&16)},startDrag:function(a,b,c){function d(a){b.ondragmove(a.clientX-h,a.clientY-
g);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}var c=c||document,h=a.clientX,g=a.clientY;if(c.addEventListener)c.addEventListener("mousemove",d,!0),c.addEventListener("mouseup",function(){c.removeEventListener("mousemove",d,!0);c.removeEventListener("mouseup",d,!0);b.ondragstop()},!0),a.preventDefault();else{var k=a.srcElement;k.setCapture();var n=function(){k.releaseCapture();k.detachEvent("onmousemove",d);k.detachEvent("onmouseup",n);k.detachEvent("onlosecaptrue",n);b.ondragstop()};
k.attachEvent("onmousemove",d);k.attachEvent("onmouseup",n);k.attachEvent("onlosecaptrue",n);a.returnValue=!1}b.ondragstart()},getFixedLayer:function(){var a=document.getElementById("edui_fixedlayer");null==a&&(a=document.createElement("div"),a.id="edui_fixedlayer",document.body.appendChild(a),c.ie&&8>=c.version?(a.style.position="absolute",d.on(window,"scroll",b),d.on(window,"resize",baidu.editor.utils.defer(b,0,!0)),setTimeout(b)):a.style.position="fixed",a.style.left="0",a.style.top="0",a.style.width=
"0",a.style.height="0");return a},makeUnselectable:function(a){if(c.opera||c.ie&&9>c.version){if(a.unselectable="on",a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)1==a.childNodes[b].nodeType&&h.makeUnselectable(a.childNodes[b])}else void 0!==a.style.MozUserSelect?a.style.MozUserSelect="none":void 0!==a.style.WebkitUserSelect?a.style.WebkitUserSelect="none":void 0!==a.style.KhtmlUserSelect&&(a.style.KhtmlUserSelect="none")}}})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.EventBase,g=baidu.editor.ui.UIBase=function(){};g.prototype={className:"",uiName:"",initOptions:function(a){for(var b in a)this[b]=a[b];this.id=this.id||"edui"+c.uid()},initUIBase:function(){this._globalKey=b.unhtml(c.setGlobal(this.id,this))},render:function(a){var b=this.renderHtml(),b=c.createElementByHtml(b),d=this.getDom();null!=d?(d.parentNode.replaceChild(b,d),c.copyAttributes(b,d)):("string"==typeof a&&(a=document.getElementById(a)),
a=a||c.getFixedLayer(),a.appendChild(b));this.postRender()},getDom:function(a){return a?document.getElementById(this.id+"_"+a):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(a){var b="edui-"+this.uiName;return a.replace(/##/g,this.id).replace(/%%-/g,this.uiName?b+"-":"").replace(/%%/g,(this.uiName?b:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},
dispose:function(){var a=this.getDom();a&&baidu.editor.dom.domUtils.remove(a);c.unsetGlobal(this.id)}};b.inherits(g,d)})();(function(){var b=baidu.editor.utils,c=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,g=baidu.editor.ui.uiUtils,a=baidu.editor.ui.Mask=function(a){this.initOptions(a);this.initUIBase()};a.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var a=this;c.on(window,"resize",function(){setTimeout(function(){a.isHidden()||a._fill()})})},show:function(a){this._fill();this.getDom().style.display="";
this.getDom().style.zIndex=a},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_fill:function(){var a=this.getDom(),b=g.getViewportRect();a.style.width=b.width+"px";a.style.height=b.height+"px"}};b.inherits(a,d)})();(function(){function b(a){for(var b=0;b<e.length;b++){var f=e[b];f.isHidden()||!1!==f.queryAutoHide(a)&&f.hide()}}var c=baidu.editor.utils,d=baidu.editor.ui.uiUtils,g=baidu.editor.dom.domUtils,a=baidu.editor.ui.UIBase,h=baidu.editor.ui.Popup=function(a){this.initOptions(a);this.initPopup()},e=[];h.postHide=b;var f=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];h.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,
initPopup:function(){this.initUIBase();e.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return"string"==typeof this.content?
this.content:this.content.renderHtml()},_UIBase_postRender:a.prototype.postRender,postRender:function(){this.content instanceof a&&this.content.postRender();this.fireEvent("postRenderAfter");this.hide(!0);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var a=this.getDom("content");return d.getClientRect(a)},fitSize:function(){var a=this.getDom("body");a.style.width="";a.style.height="";var b=this.mesureSize();a.style.width=
b.width+"px";a.style.height=b.height+"px";return b},showAnchor:function(a,b){this.showAnchorRect(d.getClientRect(a),b)},showAnchorRect:function(a,b){this._doAutoRender();var c=d.getViewportRect();this._show();var e=this.fitSize(),h,n;b?(h=this.canSideLeft&&a.right+e.width>c.right&&a.left>e.width,c=this.canSideUp&&a.top+e.height>c.bottom&&a.bottom>e.height,n=h?a.left-e.width:a.right,e=c?a.bottom-e.height:a.top):(h=this.canSideLeft&&a.right+e.width>c.right&&a.left>e.width,c=this.canSideUp&&a.top+e.height>
c.bottom&&a.bottom>e.height,n=h?a.right-e.width:a.left,e=c?a.top-e.height:a.bottom);var t=this.getDom();d.setViewportOffset(t,{left:n,top:e});g.removeClasses(t,f);t.className+=" "+f[2*(c?1:0)+(h?1:0)];this.editor&&(t.style.zIndex=1*this.editor.container.style.zIndex+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=t.style.zIndex-1)},showAt:function(a){var b=a.left,a=a.top;this.showAnchorRect({left:b,top:a,right:b,bottom:a,height:0,width:0},!1,!0)},_show:function(){this._hidden&&(this.getDom().style.display=
"",this._hidden=!1,this.fireEvent("show"))},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(a){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,a||this.fireEvent("hide"))},queryAutoHide:function(a){return!a||!d.contains(this.getDom(),a)}};c.inherits(h,a);g.on(document,"mousedown",function(a){b(a.target||a.srcElement)});g.on(window,"scroll",function(){b()})})();(function(){var b=baidu.editor.dom.domUtils,c=baidu.editor.ui.uiUtils,d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(baidu.editor.browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,Stateful_init:function(){this._Stateful_dGetHtmlTpl=
this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){return this._Stateful_dGetHtmlTpl().replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(){if(!this.isDisabled()||this.alwalysHoverable)this.addState("hover"),this.fireEvent("over")},Stateful_onMouseLeave:function(){if(!this.isDisabled()||this.alwalysHoverable)this.removeState("hover"),this.removeState("active"),this.fireEvent("out")},Stateful_onMouseOver:function(b,a){var d=b.relatedTarget;
!c.contains(a,d)&&a!==d&&this.Stateful_onMouseEnter(b,a)},Stateful_onMouseOut:function(b,a){var d=b.relatedTarget;!c.contains(a,d)&&a!==d&&this.Stateful_onMouseLeave(b,a)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(c){return b.hasClass(this.getStateDom(),"edui-state-"+c)},
addState:function(b){this.hasState(b)||(this.getStateDom().className+=" edui-state-"+b)},removeState:function(c){this.hasState(c)&&b.removeClasses(this.getStateDom(),["edui-state-"+c])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(b){!this.isDisabled()&&b?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(b){b?(this.removeState("hover"),this.removeState("checked"),
this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,g=baidu.editor.ui.Button=function(a){this.initOptions(a);this.initButton()};g.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+
(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){this.isDisabled()||this.fireEvent("click")}};b.inherits(g,c);b.extend(g.prototype,d)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,g=baidu.editor.ui.Stateful,a=baidu.editor.ui.SplitButton=function(a){this.initOptions(a);this.initSplitButton()};a.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();if(null!=this.popup){var a=this.popup;this.popup=null;this.setPopup(a)}},_UIBase_postRender:d.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},
setPopup:function(a){this.popup!==a&&(null!=this.popup&&this.popup.dispose(),a.addListener("show",b.bind(this._onPopupShow,this)),a.addListener("hide",b.bind(this._onPopupHide,this)),a.addListener("postrender",b.bind(function(){a.getDom("body").appendChild(c.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(c.getClientRect(this.getDom()).width-2)+'px"></div>'));a.getDom().className+=" "+this.className},this)),this.popup=a)},_onPopupShow:function(){this.addState("opened")},
_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var a=
c.getClientRect(this.getDom());a.top-=this.popup.SHADOW_RADIUS;a.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(a)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}};b.inherits(a,d);b.extend(a.prototype,g,!0)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,g=baidu.editor.ui.Toolbar=function(a){this.initOptions(a);this.initToolbar()};g.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(a){this.items.push(a)},getHtmlTpl:function(){for(var a=[],b=0;b<this.items.length;b++)a[b]=this.items[b].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+
a.join("")+"</div>"},postRender:function(){for(var a=this.getDom(),b=0;b<this.items.length;b++)this.items[b].postRender();c.makeUnselectable(a)},_onMouseDown:function(){return!1}};b.inherits(g,d)})();(function(){var b=baidu.editor.utils,c=baidu.editor.dom.domUtils,d=baidu.editor.ui.uiUtils,g=baidu.editor.ui.UIBase,a=baidu.editor.ui.Popup,h=baidu.editor.ui.Stateful,e=baidu.editor.ui.Menu=function(a){this.initOptions(a);this.initMenu()},f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||
[];this.initPopup();this.initItems()},initItems:function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];"-"==b?this.items[a]=this.getSeparator():b instanceof j||(this.items[a]=this.createItem(b))}},getSeparator:function(){return f},createItem:function(a){return new j(a)},_Popup_getContentHtmlTpl:a.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var a=[],b=0;b<this.items.length;b++)a[b]=this.items[b].renderHtml();
return'<div class="%%-body">'+a.join("")+"</div>"},_Popup_postRender:a.prototype.postRender,postRender:function(){for(var a=this,b=0;b<this.items.length;b++){var f=this.items[b];f.ownerMenu=this;f.postRender()}c.on(this.getDom(),"mouseover",function(b){var b=b||event,b=b.relatedTarget||b.fromElement,f=a.getDom();!d.contains(f,b)&&f!==b&&a.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(a){if(a){if(d.contains(this.getDom(),a))return!1;for(var b=0;b<this.items.length;b++)if(!1===
this.items[b].queryAutoHide(a))return!1}},clearItems:function(){for(var a=0;a<this.items.length;a++){var b=this.items[a];clearTimeout(b._showingTimer);clearTimeout(b._closingTimer);b.subMenu&&b.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&c.remove(this.getDom());this.clearItems()},dispose:function(){this.destroy()}};b.inherits(e,a);var j=baidu.editor.ui.MenuItem=function(a){this.initOptions(a);this.initUIBase();this.Stateful_init();this.subMenu&&!(this.subMenu instanceof e)&&
(this.subMenu=new e(this.subMenu))};j.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var a=this;this.addListener("over",function(){a.ownerMenu.fireEvent("submenuover",a);a.subMenu&&a.delayShowSubMenu()});this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),
this.addListener("out",function(){a.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(a._closingTimer);a._closingTimer=null;a.addState("opened")}),this.ownerMenu.addListener("hide",function(){a.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(b,f){f!==a&&a.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(b){return b&&d.contains(a.getDom(),b)?!1:this._bakQueryAutoHide(b)});this.getDom().style.tabIndex=
"-1";d.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var a=this;a.isDisabled()||(a.addState("opened"),clearTimeout(a._showingTimer),clearTimeout(a._closingTimer),a._closingTimer=null,a._showingTimer=setTimeout(function(){a.showSubMenu()},250))},delayHideSubMenu:function(){var a=this;a.isDisabled()||(a.removeState("opened"),clearTimeout(a._showingTimer),a._closingTimer||(a._closingTimer=setTimeout(function(){a.hasState("opened")||a.hideSubMenu();a._closingTimer=
null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(a){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(a)},_onClick:function(b,f){this.hasState("disabled")||!1!==this.fireEvent("click",b,f)&&(this.subMenu?this.showSubMenu():a.postHide())},showSubMenu:function(){var a=d.getClientRect(this.getDom());
a.right-=5;a.left+=2;a.width-=7;a.top-=4;a.bottom+=4;a.height+=8;this.subMenu.showAnchorRect(a,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}};b.inherits(j,g);b.extend(j.prototype,h,!0)})();(function(){var b=baidu.editor.utils,c=baidu.editor.dom.domUtils,d=baidu.editor.ui.uiUtils,g=baidu.editor.ui.Mask,a=baidu.editor.ui.UIBase,h=baidu.editor.ui.Button,e=baidu.editor.ui.Dialog=function(a){this.initOptions(a);this.initDialog()},f,j;e.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var a=this;this.initUIBase();this.modalMask=f||(f=new g({className:"edui-dialog-modalmask"}));this.dragMask=j||(j=new g({className:"edui-dialog-dragmask"}));this.closeButton=new h({className:"edui-dialog-closebutton",
title:"\u5173\u95ed\u5bf9\u8bdd\u6846",onclick:function(){a.close(!1)}});if(this.buttons)for(var b=0;b<this.buttons.length;b++)this.buttons[b]instanceof h||(this.buttons[b]=new h(this.buttons[b]))},fitSize:function(){var a=this.getDom("body"),b=this.mesureSize();a.style.width=b.width+"px";a.style.height=b.height+"px";return b},safeSetOffset:function(a){var b=this.getDom(),f=d.getViewportRect(),c=d.getClientRect(b),e=a.left;e+c.width>f.right&&(e=f.right-c.width);a=a.top;a+c.height>f.bottom&&(a=f.bottom-
c.height);b.style.left=Math.max(e,0)+"px";b.style.top=Math.max(a,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var a=d.getViewportRect(),b=this.fitSize(),f=this.getDom("titlebar").offsetHeight|0,e=a.width/2-b.width/2,a=a.height/2-(b.height-f)/2-f,b=this.getDom();this.safeSetOffset({left:Math.max(e|0,0),top:Math.max(a|0,0)});c.hasClass(b,"edui-state-centered")||(b.className+=" edui-state-centered");this._show()},getContentHtml:function(){var a="";"string"==typeof this.content?a=this.content:
this.iframeUrl&&(a='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>');return a},getHtmlTpl:function(){var a="";if(this.buttons){for(var a=[],b=0;b<this.buttons.length;b++)a[b]=this.buttons[b].renderHtml();a='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+a.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+
(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+a+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide());this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var a=this;this.addListener("show",function(){a.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){a.modalMask.hide()});
if(this.buttons)for(var b=0;b<this.buttons.length;b++)this.buttons[b].postRender();c.on(window,"resize",function(){setTimeout(function(){a.isHidden()||a.safeSetOffset(d.getClientRect(a.getDom()))})});this._hide()},mesureSize:function(){var a=this.getDom("body"),b=d.getClientRect(this.getDom("content")).width;a.style.width=b;return d.getClientRect(a)},_onTitlebarMouseDown:function(a){if(this.draggable){var b;d.getViewportRect();var f=this;d.startDrag(a,{ondragstart:function(){b=d.getClientRect(f.getDom());
f.dragMask.show(f.getDom().style.zIndex-1)},ondragmove:function(a,c){f.safeSetOffset({left:b.left+a,top:b.top+c})},ondragstop:function(){c.removeClasses(f.getDom(),["edui-state-centered"]);f.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=
this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){this.autoReset&&this.reset();this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(a){}},_onCloseButtonClick:function(){this.close(!1)},close:function(a){!1!==this.fireEvent("close",a)&&this._hide()}};b.inherits(e,a)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Menu,d=baidu.editor.ui.SplitButton,g=baidu.editor.ui.MenuButton=function(a){this.initOptions(a);this.initMenuButton()};g.prototype={initMenuButton:function(){var a=this;this.uiName="menubutton";this.popup=new c({items:a.items,className:a.className,editor:a.editor});this.popup.addListener("show",function(){for(var b=0;b<this.items.length;b++)this.items[b].removeState("checked"),this.items[b].value==a._value&&(this.items[b].addState("checked"),
this.value=a._value)});this.initSplitButton()},setValue:function(a){this._value=a}};b.inherits(g,d)})();(function(){var b=baidu.editor.browser.ie,c=baidu.editor.utils,d=baidu.editor.ui,g=d.Dialog;d.Dialog=function(a){var b=new g(a);b.addListener("hide",function(){if(b.editor){var a=b.editor;try{a.focus()}catch(f){}}});return b};var a,h,e="Undo Redo FormatMatch Bold Italic Underline StrikeThrough Subscript Superscript Source Indent Outdent BlockQuote PastePlain PageBreak SelectAll Print Preview Horizontal RemoveFormat Time Date Unlink InsertParagraphBeforeTable InsertRow InsertCol MergeRight MergeDown DeleteRow DeleteCol SplittoRows SplittoCols SplittoCells MergeCells DeleteTable".split(" ");
for(a=e.length;a--;)h=e[a],d[h]=function(a){return function(b,c){var c=c||b.options.labelMap[a.toLowerCase()]||"",e=new d.Button({className:"edui-for-"+a.toLowerCase(),title:c,onclick:function(){b.execCommand(a)},showText:!1});b.addListener("selectionchange",function(c,d,i){c=b.queryCommandState(a.toLowerCase());-1==c?(e.setDisabled(!0),e.setChecked(!1)):i||(e.setDisabled(!1),e.setChecked(c))});return e}}(h);d.SnapScreen=function(a,c){var c=c||a.options.labelMap.snapscreen||"",e=new d.Button({className:"edui-for-snapscreen",
title:c,onclick:function(){a.execCommand("SnapScreen")}});if(b){var h=a.options.iframeUrlMap.snapscreen,h=a.ui.mapUrl(h),c=c||a.options.labelMap.snapscreen||"",g=new d.Dialog({iframeUrl:h,autoReset:!0,draggable:!0,editor:a,className:"edui-for-snapscreen",title:c,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){g.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){g.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?
this.onok():this.oncancel()}});g.render();a.snapscreenInstall=g}a.addListener("selectionchange",function(){var b=a.queryCommandState("snapscreen");e.setDisabled(-1==b)});return e};d.ClearDoc=function(a,b){var b=b||a.options.labelMap.cleardoc||"",c=new d.Button({className:"edui-for-cleardoc",title:b,onclick:function(){confirm("\u786e\u5b9a\u6e05\u7a7a\u6587\u6863\u5417\uff1f")&&a.execCommand("cleardoc")}});a.addListener("selectionchange",function(){var b=a.queryCommandState("cleardoc");c.setDisabled(-1==
b)});return c};d.Justify=function(a,b,c){var b=(b||"left").toLowerCase(),c=c||a.options.labelMap["justify"+b.toLowerCase()]||"",e=new d.Button({className:"edui-for-justify"+b.toLowerCase(),title:c,onclick:function(){a.execCommand("Justify",b)}});a.addListener("selectionchange",function(c,d,i){c=a.queryCommandState("Justify");e.setDisabled(-1==c);c=a.queryCommandValue("Justify");e.setChecked(c==b&&!i)});return e};d.JustifyLeft=function(a,b){return d.Justify(a,"left",b)};d.JustifyCenter=function(a,
b){return d.Justify(a,"center",b)};d.JustifyRight=function(a,b){return d.Justify(a,"right",b)};d.JustifyJustify=function(a,b){return d.Justify(a,"justify",b)};d.ImageFloat=function(a,b,c){var b=(b||"none").toLowerCase(),c=c||a.options.labelMap["image"+b.toLowerCase()]||"",e=new d.Button({className:"edui-for-image"+b.toLowerCase(),title:c,onclick:function(){a.execCommand("imagefloat",b)}});a.addListener("selectionchange",function(){var c=a.queryCommandState("imagefloat");e.setDisabled(-1==c);c=a.queryCommandValue("imagefloat");
e.setChecked(c==b)});return e};d.ImageNone=function(a,b){return d.ImageFloat(a,b)};d.ImageLeft=function(a,b){return d.ImageFloat(a,"left",b)};d.ImageRight=function(a,b){return d.ImageFloat(a,"right",b)};d.ImageCenter=function(a,b){return d.ImageFloat(a,"center",b)};d.Directionality=function(a,b,c){var b=(b||"left").toLowerCase(),c=c||a.options.labelMap["directionality"+b.toLowerCase()]||"",e=new d.Button({className:"edui-for-directionality"+b.toLowerCase(),title:c,onclick:function(){a.execCommand("directionality",
b)},type:b});a.addListener("selectionchange",function(b,c,d){b=a.queryCommandState("directionality");e.setDisabled(-1==b);b=a.queryCommandValue("directionality");e.setChecked(b==e.type&&!d)});return e};d.DirectionalityLtr=function(a,b){return new d.Directionality(a,"ltr",b)};d.DirectionalityRtl=function(a,b){return new d.Directionality(a,"rtl",b)};e=["BackColor","ForeColor"];for(a=e.length;a--;)h=e[a],d[h]=function(a){return function(b,c){var c=c||b.options.labelMap[a.toLowerCase()]||"",e=new d.ColorButton({className:"edui-for-"+
a.toLowerCase(),color:"default",title:c,editor:b,onpickcolor:function(c,d){b.execCommand(a,d)},onpicknocolor:function(){b.execCommand(a,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){b.execCommand(a,this.color)}});b.addListener("selectionchange",function(){-1==b.queryCommandState(a)?e.setDisabled(!0):e.setDisabled(!1)});return e}}(h);e=["SearchReplace","Help","Spechars"];for(a=e.length;a--;)h=e[a],d[h]=function(a){a=a.toLowerCase();return function(b,c,e){var c=
c||b.options.iframeUrlMap[a.toLowerCase()]||"about:blank",c=b.ui.mapUrl(c),e=e||b.options.labelMap[a.toLowerCase()]||"",h=new d.Dialog({iframeUrl:c,autoReset:!0,draggable:!0,editor:b,className:"edui-for-"+a,title:e,onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render();var g=new d.Button({className:"edui-for-"+a,title:e,onclick:function(){h.open()}});b.addListener("selectionchange",function(){-1==b.queryCommandState(a)?g.setDisabled(!0):g.setDisabled(!1)});
return g}}(h);e="Attachment Anchor Link InsertImage Map GMap InsertVideo TableSuper HighlightCode InsertFrame EditTd".split(" ");for(a=e.length;a--;)h=e[a],d[h]=function(a){a=a.toLowerCase();return function(b,c,e){var c=c||b.options.iframeUrlMap[a.toLowerCase()]||"about:blank",c=b.ui.mapUrl(c),e=e||b.options.labelMap[a.toLowerCase()]||"",h=new d.Dialog({iframeUrl:c,autoReset:!0,draggable:!0,editor:b,className:"edui-for-"+a,title:e,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},
{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});h.render();var g=new d.Button({className:"edui-for-"+a,title:e,onclick:function(){h.open()}});b.addListener("selectionchange",function(){var c=b.queryCommandState(a);-1==c?g.setDisabled(!0):(g.setChecked(c),g.setDisabled(!1))});return g}}(h);d.WordImage=function(a){var b=new d.Button({className:"edui-for-wordimage",
title:"\u56fe\u7247\u8f6c\u5b58",onclick:function(){a.execCommand("wordimage","word_img");a.ui._dialogs.wordImageDialog.open()}});a.addListener("selectionchange",function(){var c=a.queryCommandState("wordimage","word_img");-1==c?b.setDisabled(!0):(b.setDisabled(!1),b.setChecked(c))});return b};d.FontFamily=function(a,b,e){for(var b=b||a.options.listMap.fontfamily||[],e=e||a.options.labelMap.fontfamily||"",h=[],g=0;g<b.length;g++){var k=b[g],n=a.options.fontMap[k],t='"'+k+'"',q=RegExp(k,"i");n&&(t=
'"'+n.join('","')+'"',q=RegExp("(?:\\|)"+n.join("|")+"(?:\\|)","i"));h.push({label:k,value:t,regex:q,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+c.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}var o=new d.Combox({editor:a,items:h,onselect:function(b,c){a.execCommand("FontFamily",this.items[c].value)},onbuttonclick:function(){this.showPopup()},title:e,initValue:a.options.ComboxInitial.FONT_FAMILY,className:"edui-for-fontfamily",indexByValue:function(a){if(a){a=
"|"+a.replace(/,/g,"|").replace(/"/g,"")+"|";a.replace(/\s*|\s*/g,"|");for(var b=0;b<this.items.length;b++)if(this.items[b].regex.test(a))return b}return-1}});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("FontFamily")?o.setDisabled(!0):(o.setDisabled(!1),(b=a.queryCommandValue("FontFamily"))&&(b=b.replace(/['"]/g,"").split(",")[0]),o.setValue(b)))});return o};d.FontSize=function(a,b,c){for(var b=b||a.options.listMap.fontsize||[],c=c||a.options.labelMap.fontsize||"",
e=[],h=0;h<b.length;h++){var g=b[h]+"px";e.push({label:g,value:g,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var n=new d.Combox({editor:a,items:e,title:c,initValue:a.options.ComboxInitial.FONT_SIZE,onselect:function(b,c){a.execCommand("FontSize",this.items[c].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("FontSize")?
n.setDisabled(!0):(n.setDisabled(!1),n.setValue(a.queryCommandValue("FontSize"))))});return n};d.Paragraph=function(a,b,c){for(var b=b||a.options.listMap.paragraph||[],c=c||a.options.labelMap.paragraph||"",e=[],h=0;h<b.length;h++){var g=b[h].split(":");e.push({label:g[1],value:g[0],renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var n=new d.Combox({editor:a,items:e,title:c,initValue:a.options.ComboxInitial.PARAGRAPH,
className:"edui-for-paragraph",onselect:function(b,c){a.execCommand("Paragraph",this.items[c].value)},onbuttonclick:function(){this.showPopup()}});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("Paragraph")?n.setDisabled(!0):(n.setDisabled(!1),b=a.queryCommandValue("Paragraph"),-1!=n.indexByValue(b)?n.setValue(b):n.setValue(n.initValue)))});return n};d.CustomStyle=function(a,b,c){for(var b=b||a.options.listMap.customstyle||[],c=c||a.options.labelMap.customstyle||"",e=
0,h=[],g;g=b[e++];)(function(a){h.push({label:a.label,value:a,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+a.tag+" "+(a.className?' class="'+a.className+'"':"")+(a.style?' style="'+a.style+'"':"")+">"+a.label+"</"+a.tag+"></div>"}})})(g);var n=new d.Combox({editor:a,items:h,title:c,initValue:a.options.ComboxInitial.CUSTOMSTYLE,className:"edui-for-customstyle",onselect:function(b,c){a.execCommand("customstyle",this.items[c].value)},onbuttonclick:function(){this.showPopup()},
indexByValue:function(a){for(var b=0,c;c=this.items[b++];)if(c.label==a)return b-1;return-1}});a.addListener("selectionchange",function(b,c,d){d||(-1==a.queryCommandState("customstyle")?n.setDisabled(!0):(n.setDisabled(!1),b=a.queryCommandValue("customstyle"),-1!=n.indexByValue(b)?n.setValue(b):n.setValue(n.initValue)))});return n};d.InsertTable=function(a,b,c){var b=b||a.options.iframeUrlMap.inserttable||"about:blank",b=a.ui.mapUrl(b),c=c||a.options.labelMap.inserttable||"",e=new d.Dialog({iframeUrl:b,
autoReset:!0,draggable:!0,editor:a,className:"edui-for-inserttable",title:c,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){e.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){e.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});e.render();a.tableDialog=e;var h=new d.TableButton({editor:a,title:c,className:"edui-for-inserttable",onpicktable:function(b,c,d){a.execCommand("InsertTable",
{numRows:d,numCols:c})},onmore:function(){e.open()},onbuttonclick:function(){e.open()}});a.addListener("selectionchange",function(){-1==a.queryCommandState("inserttable")?h.setDisabled(!0):h.setDisabled(!1)});return h};d.AutoTypeSet=function(a,b,c){var c=c||a.options.labelMap.autotypeset||"",e=new d.AutoTypeSetButton({editor:a,title:c,className:"edui-for-autotypeset",onbuttonclick:function(){a.execCommand("autotypeset")}});a.addListener("selectionchange",function(){e.setDisabled(-1==a.queryCommandState("autotypeset"))});
return e};d.LineHeight=function(a,b){for(var c=0,e,h=[];e=a.options.listMap.lineheight[c++];)h.push({label:"1"==e?"\u9ed8\u8ba4":e,value:e,onclick:function(){a.execCommand("lineheight",this.value)}});var g=new d.MenuButton({editor:a,className:"edui-for-lineheight",title:b||a.options.labelMap.lineheight||"",items:h,onbuttonclick:function(){var b=a.queryCommandValue("LineHeight")||this.value;a.execCommand("LineHeight",b)}});a.addListener("selectionchange",function(){var b=a.queryCommandState("LineHeight");
if(-1==b)g.setDisabled(!0);else{g.setDisabled(!1);var c=a.queryCommandValue("LineHeight");c&&g.setValue((c+"").replace(/cm/,""));g.setChecked(b)}});return g};d.RowSpacingTop=function(a,b){for(var c=0,e,h=[];e=a.options.listMap.rowspacing[c++];)h.push({label:e,value:e,onclick:function(){a.execCommand("rowspacing",this.value,"top")}});var g=new d.MenuButton({editor:a,className:"edui-for-rowspacingtop",title:b||a.options.labelMap.rowspacingtop||"\u6bb5\u524d\u95f4\u8ddd",items:h,onbuttonclick:function(){var b=
a.queryCommandValue("rowspacing","top")||this.value;a.execCommand("rowspacing",b,"top")}});a.addListener("selectionchange",function(){var b=a.queryCommandState("rowspacing","top");if(-1==b)g.setDisabled(!0);else{g.setDisabled(!1);var c=a.queryCommandValue("rowspacing","top");c&&g.setValue((c+"").replace(/%/,""));g.setChecked(b)}});return g};d.RowSpacingBottom=function(a,b){for(var c=0,e,h=[];e=a.options.listMap.rowspacing[c++];)h.push({label:e,value:e,onclick:function(){a.execCommand("rowspacing",
this.value,"bottom")}});var g=new d.MenuButton({editor:a,className:"edui-for-rowspacingbottom",title:b||a.options.labelMap.rowspacingbottom||"\u6bb5\u540e\u95f4\u8ddd",items:h,onbuttonclick:function(){var b=a.queryCommandValue("rowspacing","bottom")||this.value;a.execCommand("rowspacing",b,"bottom")}});a.addListener("selectionchange",function(){var b=a.queryCommandState("rowspacing","bottom");if(-1==b)g.setDisabled(!0);else{g.setDisabled(!1);var c=a.queryCommandValue("rowspacing","bottom");c&&g.setValue((c+
"").replace(/%/,""));g.setChecked(b)}});return g};d.InsertOrderedList=function(a,b){var b=b||a.options.labelMap.insertorderedlist||"",c=function(){a.execCommand("InsertOrderedList",this.value)},e=new d.MenuButton({editor:a,className:"edui-for-insertorderedlist",title:b,items:[{label:"1,2,3...",value:"decimal",onclick:c},{label:"a,b,c ...",value:"lower-alpha",onclick:c},{label:"i,ii,iii...",value:"lower-roman",onclick:c},{label:"A,B,C",value:"upper-alpha",onclick:c},{label:"I,II,III...",value:"upper-roman",
onclick:c}],onbuttonclick:function(){var b=a.queryCommandValue("InsertOrderedList")||this.value;a.execCommand("InsertOrderedList",b)}});a.addListener("selectionchange",function(){var b=a.queryCommandState("InsertOrderedList");if(-1==b)e.setDisabled(!0);else{e.setDisabled(!1);var c=a.queryCommandValue("InsertOrderedList");e.setValue(c);e.setChecked(b)}});return e};d.InsertUnorderedList=function(a,b){var b=b||a.options.labelMap.insertunorderedlist||"",c=function(){a.execCommand("InsertUnorderedList",
this.value)},e=new d.MenuButton({editor:a,className:"edui-for-insertunorderedlist",title:b,items:[{label:"\u25cb \u5c0f\u5706\u5708",value:"circle",onclick:c},{label:"\u25cf \u5c0f\u5706\u70b9",value:"disc",onclick:c},{label:"\u25a0 \u5c0f\u65b9\u5757",value:"square",onclick:c}],onbuttonclick:function(){var b=a.queryCommandValue("InsertUnorderedList")||this.value;a.execCommand("InsertUnorderedList",b)}});a.addListener("selectionchange",function(){var b=a.queryCommandState("InsertUnorderedList");if(-1==
b)e.setDisabled(!0);else{e.setDisabled(!1);var c=a.queryCommandValue("InsertUnorderedList");e.setValue(c);e.setChecked(b)}});return e};d.FullScreen=function(a,b){var b=b||a.options.labelMap.fullscreen||"",c=new d.Button({className:"edui-for-fullscreen",title:b,onclick:function(){a.ui&&a.ui.setFullScreen(!a.ui.isFullScreen());this.setChecked(a.ui.isFullScreen())}});a.addListener("selectionchange",function(){var b=a.queryCommandState("fullscreen");c.setDisabled(-1==b);c.setChecked(a.ui.isFullScreen())});
return c};d.Emotion=function(a,b,c){var c=c||a.options.labelMap.emotion||"",b=b||a.options.iframeUrlMap.emotion||"about:blank",b=a.ui.mapUrl(b),e=new d.MultiMenuPop({title:c,editor:a,className:"edui-for-emotion",iframeUrl:b});a.addListener("selectionchange",function(){-1==a.queryCommandState("emotion")?e.setDisabled(!0):e.setDisabled(!1)});return e}})();(function(){function b(a){this.initOptions(a);this.initEditorUI()}var c=baidu.editor.utils,d=baidu.editor.ui.uiUtils,g=baidu.editor.ui.UIBase;b.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var a=this.editor,b=a.options.iframeUrlMap;a.addListener("ready",function(){baidu.editor.dom.domUtils.on(a.window,"scroll",function(){baidu.editor.ui.Popup.postHide()});a.options.elementPathEnabled&&(a.ui.getDom("elementpath").innerHTML=
'<div class="edui-editor-breadcrumb">path:</div>');a.options.wordCount&&(a.ui.getDom("wordcount").innerHTML="\u5b57\u6570\u7edf\u8ba1");a.selection.isFocus()&&a.fireEvent("selectionchange",!1,!0)});a.addListener("mousedown",function(a,b){baidu.editor.ui.Popup.postHide(b.target||b.srcElement)});a.addListener("contextmenu",function(){baidu.editor.ui.Popup.postHide()});var c=this;a.addListener("selectionchange",function(){a.selection.isFocus()&&(c._updateElementPath(),c._wordCount())});a.addListener("sourcemodechanged",
function(b,d){a.options.elementPathEnabled&&(d?c.disableElementPath():c.enableElementPath());a.options.wordCount&&(d?c.disableWordCount():c.enableWordCount())});var d=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.link):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-link",title:"\u8d85\u94fe\u63a5",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){d.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){d.close(!1)}}],onok:function(){},
oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});d.render();var g=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.insertimage):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertimage",title:"\u56fe\u7247",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){g.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){g.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?
this.onok():this.oncancel()}});g.render();var i=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.anchor):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-anchor",title:"\u951a\u70b9",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){i.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){i.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});i.render();var m=new baidu.editor.ui.Dialog({iframeUrl:b?
a.ui.mapUrl(b.insertvideo):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertvideo",title:"\u89c6\u9891",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){m.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){m.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});m.render();var l=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.wordimage):"",autoReset:!0,draggable:!0,
editor:a,className:"edui-for-wordimage",title:"\u56fe\u7247\u8f6c\u5b58",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){l.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});l.render();c._dialogs.wordImageDialog=l;var k=new baidu.editor.ui.Dialog({iframeUrl:b?c.mapUrl(b.edittd):"about:blank",autoReset:!0,draggable:!0,editor:a,
className:"edui-for-edittd",title:"\u5355\u5143\u683c",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){k.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){k.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});k.render();c._dialogs.tdDialog=k;var n=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.map):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-map",title:"\u5730\u56fe",
buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){n.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){n.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});n.render();var t=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.gmap):"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-gmap",title:"Google\u5730\u56fe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",
onclick:function(){t.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){t.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});t.render();var q=new baidu.editor.ui.Popup({editor:a,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();d.open()},_onImgEditButtonClick:function(){this.hide();var b=a.selection.getRange().getClosedNode();(b=baidu.editor.dom.domUtils.findParentByTagName(b,
"img",!0))&&-1!=b.className.indexOf("edui-faked-video")?m.open():b&&-1!=b.src.indexOf("http://api.map.baidu.com")?n.open():b&&-1!=b.src.indexOf("http://maps.google.com/maps/api/staticmap")?t.open():b&&b.getAttribute("anchorname")?i.open():b&&b.getAttribute("word_img")?(a.word_img=[b.getAttribute("word_img")],a.ui._dialogs.wordImageDialog.open()):g.open()},_getImg:function(){var b=a.selection.getRange().getClosedNode();return b&&("img"==b.nodeName||"IMG"==b.nodeName)?b:null},_onImgSetFloat:function(b){this._getImg()&&
(a.execCommand("imagefloat",b),(b=this._getImg())&&this.showAnchor(b))},_setIframeAlign:function(a){var b=q.anchorEl,c=b.cloneNode(!0);switch(a){case -2:c.setAttribute("align","");break;case -1:c.setAttribute("align","left");break;case 1:c.setAttribute("align","right");break;case 2:c.setAttribute("align","middle")}b.parentNode.insertBefore(c,b);baidu.editor.dom.domUtils.remove(b);q.anchorEl=c;q.showAnchor(q.anchorEl)},_updateIframe:function(){a._iframe=q.anchorEl;o.open();q.hide()},_onRemoveButtonClick:function(){var b=
a.selection.getRange().getClosedNode();(b=baidu.editor.dom.domUtils.findParentByTagName(b,"img",!0))&&b.getAttribute("anchorname")?a.execCommand("anchor"):a.execCommand("unlink");this.hide()},queryAutoHide:function(b){return b&&b.ownerDocument==a.document&&("img"==b.tagName.toLowerCase()||baidu.editor.dom.domUtils.findParentByTagName(b,"a",!0))?b!==q.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,b)}});q.render();var o=new baidu.editor.ui.Dialog({iframeUrl:b?a.ui.mapUrl(b.insertframe):
"",autoReset:!0,draggable:!0,editor:a,className:"edui-for-insertframe",title:"\u63d2\u5165iframe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){o.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){o.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(a,b){return b?this.onok():this.oncancel()}});o.render();a.addListener("mouseover",function(b,c){var c=c||window.event,e=c.target||c.srcElement;if(/iframe/ig.test(e.tagName)&&
a.options.imagePopup){var d=q.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._setIframeAlign(-2) class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">\u5de6\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">\u53f3\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._updateIframe( this);" class="edui-clickable">\u4fee\u6539</span></nobr>');
d?(q.getDom("content").innerHTML=d,q.anchorEl=e,q.showAnchor(q.anchorEl)):q.hide()}});a.addListener("selectionchange",function(b,c){if(c){var e="",d=a.selection.getRange().getClosedNode();null!=d&&"img"==d.tagName.toLowerCase()&&(d.getAttribute("anchorname")?e+=q.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable">\u4fee\u6539</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable">\u5220\u9664</span></nobr>'):a.options.imagePopup&&
(e+=q.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgSetFloat("none") class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">\u5c45\u5de6</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">\u5c45\u53f3</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable">\u4fee\u6539</span></nobr>')));
var f;f=a.selection.getRange().collapsed?a.queryCommandValue("link"):a.selection.getStart();f=baidu.editor.dom.domUtils.findParentByTagName(f,"a",!0);var g;if(null!=f&&null!=(g=f.getAttribute("data_ue_src")||f.getAttribute("href",2))){var h=g;30<g.length&&(h=g.substring(0,20)+"...");e&&(e+='<div style="height:5px;"></div>');e+=q.formatHtml('<nobr>\u94fe\u63a5: <a target="_blank" href="'+g+'" title="'+g+'" >'+h+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);">\u4fee\u6539</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> \u6e05\u9664</span></nobr>');
q.showAnchor(f)}e?(q.getDom("content").innerHTML=e,q.anchorEl=d||f,q.showAnchor(q.anchorEl)):q.hide()}})},_initToolbars:function(){for(var a=this.editor,b=this.toolbars||[],c=[],d=0;d<b.length;d++){for(var g=b[d],i=new baidu.editor.ui.Toolbar,m=0;m<g.length;m++){var l=g[m],k=null;if("string"==typeof l){if("|"==l&&(l="Separator"),baidu.editor.ui[l]&&(k=new baidu.editor.ui[l](a)),"FullScreen"==l){c&&c[0]?c[0].items.splice(0,0,k):i.items.splice(0,0,k);continue}}else k=l;k&&i.add(k)}c[d]=i}this.toolbars=
c},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div><div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">\u70b9\u6b64\u4e0a\u4f20</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td></tr></table></div></div>'},
showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){for(var a=[],b=0;b<this.toolbars.length;b++)a.push(this.toolbars[b].renderHtml());return a.join("")},setFullScreen:function(a){if(this._fullscreen!=a){this._fullscreen=a;this.editor.fireEvent("beforefullscreenchange",a);var b=this.editor;a?(domUtils.addClassName(document.body,"js-ueditor-fullscreen"),domUtils.addClassName(this.editor.document.documentElement,
"js-in-ueditor-fullscreen"),this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.bakAutoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakAutoHeight&&this.editor.disableAutoHeight(),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,
this._updateFullScreen()):(domUtils.delClassName(document.body,"js-ueditor-fullscreen"),domUtils.delClassName(this.editor.document.documentElement,"js-in-ueditor-fullscreen"),this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&this.editor.enableAutoHeight(null,null,!0),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,window.scrollTo(0,this._bakScrollTop));setTimeout(function(){try{b.execCommand("inserthtml",
"");b.focus()}catch(a){}},10);this.editor.fireEvent("fullscreenchanged",a);this.triggerLayout()}},_wordCount:function(){var a=this.getDom("wordcount");this.editor.options.wordCount?a.innerHTML=this.editor.queryCommandValue("wordcount"):a.style.display="none"},disableWordCount:function(){var a=this.getDom("wordcount");a.innerHTML="";a.style.display="none";this.wordcount=!1},enableWordCount:function(){this.getDom("wordcount").style.display="";this.wordcount=!0;this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var a=
d.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+a.width+"px;height:"+a.height+"px;z-index:"+(1*this.getDom().style.zIndex+100);d.setViewportOffset(this.getDom(),{left:0,top:0});this.editor.setHeight(a.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight)}},_updateElementPath:function(){var a=this.getDom("elementpath"),b;if(this.elementPathEnabled&&(b=this.editor.queryCommandValue("elementpath"))){for(var c=[],d=0,g;g=
b[d];d++)c[d]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+d+'&quot;);">'+g+"</span>");a.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+c.join(" &gt; ")+"</div>"}else a.style.display="none"},disableElementPath:function(){var a=this.getDom("elementpath");a.innerHTML="";a.style.display="none";this.elementPathEnabled=!1},enableElementPath:function(){this.getDom("elementpath").style.display="";this.elementPathEnabled=
!0;this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){g.prototype.postRender.call(this);for(var a=0;a<this.toolbars.length;a++)this.toolbars[a].postRender();var b=this,c,d=baidu.editor.dom.domUtils,j=function(){clearTimeout(c);c=setTimeout(function(){b._updateFullScreen()})};d.on(window,"resize",j);b.addListener("destroy",function(){d.un(window,"resize",j);clearTimeout(c)})},showToolbarMsg:function(a,b){this.getDom("toolbarmsg_label").innerHTML=a;this.getDom("toolbarmsg").style.display=
"";b||(this.getDom("upload_dialog").style.display="none")},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(a){return a.replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var a=this.getDom();a.style.zoom="1"==a.style.zoom?"100%":"1"}};c.inherits(b,baidu.editor.ui.UIBase);baidu.editor.ui.Editor=function(a){var c=new baidu.editor.Editor(a);c.options.editor=c;new b(c.options);var d=c.render;c.render=function(a){if(a&&(a.constructor===
String&&(a=document.getElementById(a)),a&&a.getAttribute("name")&&(c.options.textarea=a.getAttribute("name")),a&&/script|textarea/ig.test(a.tagName))){var b=document.createElement("div");a.parentNode.insertBefore(b,a);c.options.initialContent=a.value||a.innerHTML;a.id&&(b.id=a.id);a.className&&(b.className=a.className);a.style.cssText&&(b.style.cssText=a.style.cssText);a.parentNode.removeChild(a);a=b;a.innerHTML=""}c.ui.render(a);a=c.ui.getDom("iframeholder");c.container=c.ui.getDom();c.container.style.zIndex=
c.options.zIndex;d.call(c,a)};return c}})();
